
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Signal processing &#8212; Elephant 0.5.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/my-styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/elephant_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Spectral analysis" href="spectral.html" />
    <link rel="prev" title="Spike train statistics" href="statistics.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/elephant_logo_sidebar.png"></span>
          Elephant</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Prerequisites / Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">Function Reference by Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide.html">Developers&#8217; guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc_style_guidelines.html">Documentation and style guideline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors and contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">This Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Signal processing</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="statistics.html" title="Previous Chapter: Spike train statistics"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Spike train s...</span>
    </a>
  </li>
  <li>
    <a href="spectral.html" title="Next Chapter: Spectral analysis"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Spectral analysis &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="signal-processing">
<h1>Signal processing<a class="headerlink" href="#signal-processing" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-elephant.signal_processing"></span><p>Basic processing procedures for analog signals (e.g., performing a z-score of a
signal, or filtering a signal).</p>
<dl class="function">
<dt id="elephant.signal_processing.butter">
<code class="descclassname">elephant.signal_processing.</code><code class="descname">butter</code><span class="sig-paren">(</span><em>signal</em>, <em>highpass_freq=None</em>, <em>lowpass_freq=None</em>, <em>order=4</em>, <em>filter_function='filtfilt'</em>, <em>fs=1.0</em>, <em>axis=-1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/signal_processing.html#butter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.signal_processing.butter" title="Permalink to this definition">¶</a></dt>
<dd><p>Butterworth filtering function for neo.AnalogSignal. Filter type is
determined according to how values of <cite>highpass_freq</cite> and <cite>lowpass_freq</cite>
are given (see Parameters section for details).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>signal</strong> : AnalogSignal or Quantity array or NumPy ndarray</p>
<blockquote>
<div><p>Time series data to be filtered. When given as Quantity array or NumPy
ndarray, the sampling frequency should be given through the keyword
argument <cite>fs</cite>.</p>
</div></blockquote>
<p><strong>highpass_freq, lowpass_freq</strong> : Quantity or float</p>
<blockquote>
<div><p>High-pass and low-pass cut-off frequencies, respectively. When given as
float, the given value is taken as frequency in Hz.
Filter type is determined depending on values of these arguments:</p>
<blockquote>
<div><ul class="simple">
<li>highpass_freq only (lowpass_freq = None):    highpass filter</li>
<li>lowpass_freq only (highpass_freq = None):    lowpass filter</li>
<li>highpass_freq &lt; lowpass_freq:    bandpass filter</li>
<li>highpass_freq &gt; lowpass_freq:    bandstop filter</li>
</ul>
</div></blockquote>
</div></blockquote>
<p><strong>order</strong> : int</p>
<blockquote>
<div><p>Order of Butterworth filter. Default is 4.</p>
</div></blockquote>
<p><strong>filter_function</strong> : string</p>
<blockquote>
<div><p>Filtering function to be used. Either &#8216;filtfilt&#8217;
(<cite>scipy.signal.filtfilt()</cite>) or &#8216;lfilter&#8217; (<cite>scipy.signal.lfilter()</cite>). In
most applications &#8216;filtfilt&#8217; should be used, because it doesn&#8217;t bring
about phase shift due to filtering. Default is &#8216;filtfilt&#8217;.</p>
</div></blockquote>
<p><strong>fs</strong> : Quantity or float</p>
<blockquote>
<div><p>The sampling frequency of the input time series. When given as float,
its value is taken as frequency in Hz. When the input is given as neo
AnalogSignal, its attribute is used to specify the sampling
frequency and this parameter is ignored. Default is 1.0.</p>
</div></blockquote>
<p><strong>axis</strong> : int</p>
<blockquote>
<div><p>Axis along which filter is applied. Default is -1.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>filtered_signal</strong> : AnalogSignal or Quantity array or NumPy ndarray</p>
<blockquote class="last">
<div><p>Filtered input data. The shape and type is identical to those of the
input.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="elephant.signal_processing.hilbert">
<code class="descclassname">elephant.signal_processing.</code><code class="descname">hilbert</code><span class="sig-paren">(</span><em>signal</em>, <em>N='nextpow'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/signal_processing.html#hilbert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.signal_processing.hilbert" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a Hilbert transform to an AnalogSignal object in order to obtain its
(complex) analytic signal.</p>
<p>The time series of the instantaneous angle and amplitude can be obtained as
the angle (np.angle) and absolute value (np.abs) of the complex analytic
signal, respectively.</p>
<p>By default, the function will zero-pad the signal to a length corresponding
to the next higher power of 2. This will provide higher computational
efficiency at the expense of memory. In addition, this circumvents a
situation where for some specific choices of the length of the input,
scipy.signal.hilbert() will not terminate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>signal</strong> : neo.AnalogSignal</p>
<blockquote>
<div><p>Signal(s) to transform</p>
</div></blockquote>
<p><strong>N</strong> : string or int</p>
<blockquote>
<div><dl class="docutils">
<dt>Defines whether the signal is zero-padded.</dt>
<dd><p class="first">&#8216;none&#8217;: no padding
&#8216;nextpow&#8217;:  zero-pad to the next length that is a power of 2
int: directly specify the length to zero-pad to (indicates the</p>
<blockquote class="last">
<div><p>number of Fourier components, see parameter N of
scipy.signal.hilbert()).</p>
</div></blockquote>
</dd>
</dl>
<p>Default: &#8216;nextpow&#8217;.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">neo.AnalogSignal</p>
<blockquote class="last">
<div><p>Contains the complex analytic signal(s) corresponding to the input
signals. The unit of the analytic signal is dimensionless.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="elephant.signal_processing.zscore">
<code class="descclassname">elephant.signal_processing.</code><code class="descname">zscore</code><span class="sig-paren">(</span><em>signal</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/signal_processing.html#zscore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.signal_processing.zscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a z-score operation to one or several AnalogSignal objects.</p>
<p>The z-score operation subtracts the mean <img class="math" src="../_images/math/d79e8a2c7ce54906c2b25549da38bdbe02cf40d6.png" alt="\mu"/> of the signal, and
divides by its standard deviation <img class="math" src="../_images/math/011e5790a6c33043ceadca81d9657dde6c61d769.png" alt="\sigma"/>:</p>
<div class="math">
<p><img src="../_images/math/3d6bc41ea8f5f13979df43babd24c369f1ba93b2.png" alt="Z(x(t))= \frac{x(t)-\mu}{\sigma}"/></p>
</div><p>If an AnalogSignal containing multiple signals is provided, the
z-transform is always calculated for each signal individually.</p>
<p>If a list of AnalogSignal objects is supplied, the mean and standard
deviation are calculated across all objects of the list. Thus, all list
elements are z-transformed by the same values of <img class="math" src="../_images/math/d79e8a2c7ce54906c2b25549da38bdbe02cf40d6.png" alt="\mu"/> and
<img class="math" src="../_images/math/011e5790a6c33043ceadca81d9657dde6c61d769.png" alt="\sigma"/>. For AnalogSignals, each signal of the array is
treated separately across list elements. Therefore, the number of signals
must be identical for each AnalogSignal of the list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>signal</strong> : neo.AnalogSignal or list of neo.AnalogSignal</p>
<blockquote>
<div><p>Signals for which to calculate the z-score.</p>
</div></blockquote>
<p><strong>inplace</strong> : bool</p>
<blockquote>
<div><p>If True, the contents of the input signal(s) is replaced by the
z-transformed signal. Otherwise, a copy of the original
AnalogSignal(s) is returned. Default: True</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">neo.AnalogSignal or list of neo.AnalogSignal</p>
<blockquote class="last">
<div><p>The output format matches the input format: for each supplied
AnalogSignal object a corresponding object is returned containing
the z-transformed signal with the unit dimensionless.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">neo</span><span class="o">.</span><span class="n">AnalogSignal</span><span class="p">(</span>
<span class="gp">... </span>      <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">mV</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="o">*</span><span class="n">Hz</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">neo</span><span class="o">.</span><span class="n">AnalogSignal</span><span class="p">(</span>
<span class="gp">... </span>      <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">]])</span><span class="o">*</span><span class="n">mV</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="o">*</span><span class="n">Hz</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">neo</span><span class="o">.</span><span class="n">AnalogSignal</span><span class="p">(</span>
<span class="gp">... </span>      <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">],</span> <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">]])</span><span class="o">*</span><span class="n">mV</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">t_start</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="o">*</span><span class="n">Hz</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">zscore</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">[[-1.46385011]</span>
<span class="go"> [-0.87831007]</span>
<span class="go"> [-0.29277002]</span>
<span class="go"> [ 0.29277002]</span>
<span class="go"> [ 0.87831007]</span>
<span class="go"> [ 1.46385011]] dimensionless</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">zscore</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">[[-1.46385011 -1.46385011]</span>
<span class="go"> [-0.87831007 -0.87831007]</span>
<span class="go"> [-0.29277002 -0.29277002]</span>
<span class="go"> [ 0.29277002  0.29277002]</span>
<span class="go"> [ 0.87831007  0.87831007]</span>
<span class="go"> [ 1.46385011  1.46385011]] dimensionless</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">zscore</span><span class="p">([</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">])</span>
<span class="go">[&lt;AnalogSignal(array([[-1.11669108, -1.08361877],</span>
<span class="go">   [-1.0672076 , -1.04878252],</span>
<span class="go">   [-1.01772411, -1.01394628],</span>
<span class="go">   [-0.96824063, -0.97911003],</span>
<span class="go">   [-0.91875714, -0.94427378],</span>
<span class="go">   [-0.86927366, -0.90943753]]) * dimensionless, [0.0 s, 0.006 s],</span>
<span class="go">   sampling rate: 1000.0 Hz)&gt;,</span>
<span class="go">   &lt;AnalogSignal(array([[ 0.78170952,  0.84779261],</span>
<span class="go">   [ 0.86621866,  0.90728682],</span>
<span class="go">   [ 0.9507278 ,  0.96678104],</span>
<span class="go">   [ 1.03523694,  1.02627526],</span>
<span class="go">   [ 1.11974608,  1.08576948],</span>
<span class="go">   [ 1.20425521,  1.1452637 ]]) * dimensionless, [0.0 s, 0.006 s],</span>
<span class="go">   sampling rate: 1000.0 Hz)&gt;]</span>
</pre></div>
</div>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014-2018, Elephant authors and contributors.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>