
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Spike train statistics &#8212; Elephant 0.5.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/my-styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/elephant_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Signal processing" href="signal_processing.html" />
    <link rel="prev" title="Function Reference by Module" href="../modules.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/elephant_logo_sidebar.png"></span>
          Elephant</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Prerequisites / Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">Function Reference by Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide.html">Developers&#8217; guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc_style_guidelines.html">Documentation and style guideline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors and contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">This Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Spike train statistics</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../modules.html" title="Previous Chapter: Function Reference by Module"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Function Refe...</span>
    </a>
  </li>
  <li>
    <a href="signal_processing.html" title="Next Chapter: Signal processing"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Signal processing &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="module-elephant.statistics">
<span id="spike-train-statistics"></span><h1>Spike train statistics<a class="headerlink" href="#module-elephant.statistics" title="Permalink to this headline">¶</a></h1>
<p>Statistical measures of spike trains (e.g., Fano factor) and functions to estimate firing rates.</p>
<dl class="function">
<dt id="elephant.statistics.complexity_pdf">
<code class="descclassname">elephant.statistics.</code><code class="descname">complexity_pdf</code><span class="sig-paren">(</span><em>spiketrains</em>, <em>binsize</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#complexity_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.complexity_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Complexity Distribution [1] of a list of <code class="xref py py-attr docutils literal"><span class="pre">neo.SpikeTrain</span></code> objects.</p>
<p>Probability density computed from the complexity histogram which is the
histogram of the entries of the population histogram of clipped (binary)
spike trains computed with a bin width of binsize.
It provides for each complexity (== number of active neurons per bin) the
number of occurrences. The normalization of that histogram to 1 is the
probability density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spiketrains</strong> : List of neo.SpikeTrain objects</p>
<p><strong>Spiketrains with a common time axis (same `t_start` and `t_stop`)</strong></p>
<p><strong>binsize</strong> : quantities.Quantity</p>
<p><strong>Width of the histogram&#8217;s time bins.</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>time_hist</strong> : neo.AnalogSignal</p>
<p>A neo.AnalogSignal object containing the histogram values.</p>
<p class="last"><cite>AnalogSignal[j]</cite> is the histogram computed between .</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../source/elephant.conversion.html#elephant.conversion.BinnedSpikeTrain" title="elephant.conversion.BinnedSpikeTrain"><code class="xref py py-obj docutils literal"><span class="pre">elephant.conversion.BinnedSpikeTrain</span></code></a></p>
</div>
<p class="rubric">References</p>
<p>[1]Gruen, S., Abeles, M., &amp; Diesmann, M. (2008). Impact of higher-order
correlations on coincidence distributions of massively parallel data.
In Dynamic Brain-from Neural Spikes to Behaviors (pp. 96-114).
Springer Berlin Heidelberg.</p>
</dd></dl>

<dl class="function">
<dt id="elephant.statistics.cost_function">
<code class="descclassname">elephant.statistics.</code><code class="descname">cost_function</code><span class="sig-paren">(</span><em>x</em>, <em>N</em>, <em>w</em>, <em>dt</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#cost_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.cost_function" title="Permalink to this definition">¶</a></dt>
<dd><p>The cost function
Cn(w) = sum_{i,j} int k(x - x_i) k(x - x_j) dx - 2 sum_{i~=j} k(x_i - x_j)</p>
</dd></dl>

<dl class="function">
<dt id="elephant.statistics.cv2">
<code class="descclassname">elephant.statistics.</code><code class="descname">cv2</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#cv2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.cv2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the measure of CV2 for a sequence of time intervals between 
events.</p>
<p>Given a vector v containing a sequence of intervals, the CV2 is
defined as:</p>
<p>.math $$ CV2 := frac{1}{N}sum_{i=1}^{N-1}</p>
<blockquote>
<div><dl class="docutils">
<dt>frac{2|isi_{i+1}-isi_i|}</dt>
<dd>{<a href="#id5"><span class="problematic" id="id6">|isi_{i+1}+isi_i|</span></a>} $$</dd>
</dl>
</div></blockquote>
<p>The CV2 is typically computed as a substitute for the classical
coefficient of variation (CV) for sequences of events which include
some (relatively slow) rate fluctuation.  As with the CV, CV2=1 for
a sequence of intervals generated by a Poisson process.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>v</strong> : quantity array, numpy array or list</p>
<blockquote>
<div><p>Vector of consecutive time intervals</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>cv2</strong> : float</p>
<blockquote>
<div><p>The CV2 of the inter-spike interval of the input sequence.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>AttributeError :</strong></p>
<blockquote>
<div><p>If an empty list is specified, or if the sequence has less
than two entries, an AttributeError will be raised.</p>
</div></blockquote>
<p><strong>AttributeError :</strong></p>
<blockquote class="last">
<div><p>Only vector inputs are supported.  If a matrix is passed to the
function an AttributeError will be raised.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>..[1] Holt, G. R., Softky, W. R., Koch, C., &amp; Douglas, R. J. (1996). 
Comparison of discharge variability in vitro and in vivo in cat visual 
cortex neurons. Journal of neurophysiology, 75(5), 1806-1814.</p>
</dd></dl>

<dl class="function">
<dt id="elephant.statistics.fanofactor">
<code class="descclassname">elephant.statistics.</code><code class="descname">fanofactor</code><span class="sig-paren">(</span><em>spiketrains</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#fanofactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.fanofactor" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the empirical Fano factor F of the spike counts of
a list of <cite>neo.core.SpikeTrain</cite> objects.</p>
<p>Given the vector v containing the observed spike counts (one per
spike train) in the time window [t0, t1], F is defined as:</p>
<blockquote>
<div>F := var(v)/mean(v).</div></blockquote>
<p>The Fano factor is typically computed for spike trains representing the
activity of the same neuron over different trials. The higher F, the larger
the cross-trial non-stationarity. In theory for a time-stationary Poisson
process, F=1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spiketrains</strong> : list of neo.SpikeTrain objects, quantity arrays, numpy arrays or lists</p>
<blockquote>
<div><p>Spike trains for which to compute the Fano factor of spike counts.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fano</strong> : float or nan</p>
<blockquote class="last">
<div><p>The Fano factor of the spike counts of the input spike trains. If an
empty list is specified, or if all spike trains are empty, F:=nan.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="elephant.statistics.fftkernel">
<code class="descclassname">elephant.statistics.</code><code class="descname">fftkernel</code><span class="sig-paren">(</span><em>x</em>, <em>w</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#fftkernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.fftkernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Function <a href="#id1"><span class="problematic" id="id2">`</span></a>fftkernel&#8217; applies the Gauss kernel smoother to an input
signal using FFT algorithm.</p>
<p>Input argument
x:    Sample signal vector.
w:  Kernel bandwidth (the standard deviation) in unit of
the sampling resolution of x.</p>
<p>Output argument
y:  Smoothed signal.</p>
<p>MAY 5/23, 2012 Author Hideaki Shimazaki
RIKEN Brain Science Insitute
<a class="reference external" href="http://2000.jukuin.keio.ac.jp/shimazaki">http://2000.jukuin.keio.ac.jp/shimazaki</a></p>
<p>Ported to Python: Subhasis Ray, NCBS. Tue Jun 10 10:42:38 IST 2014</p>
</dd></dl>

<dl class="function">
<dt id="elephant.statistics.instantaneous_rate">
<code class="descclassname">elephant.statistics.</code><code class="descname">instantaneous_rate</code><span class="sig-paren">(</span><em>spiketrain</em>, <em>sampling_period</em>, <em>kernel='auto'</em>, <em>cutoff=5.0</em>, <em>t_start=None</em>, <em>t_stop=None</em>, <em>trim=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#instantaneous_rate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.instantaneous_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates instantaneous firing rate by kernel convolution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spiketrain</strong> : neo.SpikeTrain or list of neo.SpikeTrain objects</p>
<blockquote>
<div><p>Neo object that contains spike times, the unit of the time stamps
and t_start and t_stop of the spike train.</p>
</div></blockquote>
<p><strong>sampling_period</strong> : Time Quantity</p>
<blockquote>
<div><p>Time stamp resolution of the spike times. The same resolution will
be assumed for the kernel</p>
</div></blockquote>
<p><strong>kernel</strong> : string &#8216;auto&#8217; or callable object of <code class="xref py py-class docutils literal"><span class="pre">Kernel</span></code> from module</p>
<blockquote>
<div><p>&#8216;kernels.py&#8217;. Currently implemented kernel forms are rectangular,
triangular, epanechnikovlike, gaussian, laplacian, exponential,
and alpha function.
Example: kernel = kernels.RectangularKernel(sigma=10*ms, invert=False)
The kernel is used for convolution with the spike train and its
standard deviation determines the time resolution of the instantaneous
rate estimation.
Default: &#8216;auto&#8217;. In this case, the optimized kernel width for the 
rate estimation is calculated according to [1] and with this width
a gaussian kernel is constructed. Automatized calculation of the 
kernel width is not available for other than gaussian kernel shapes.</p>
</div></blockquote>
<p><strong>cutoff</strong> : float</p>
<blockquote>
<div><p>This factor determines the cutoff of the probability distribution of
the kernel, i.e., the considered width of the kernel in terms of 
multiples of the standard deviation sigma.
Default: 5.0</p>
</div></blockquote>
<p><strong>t_start</strong> : Time Quantity (optional)</p>
<blockquote>
<div><p>Start time of the interval used to compute the firing rate. If None
assumed equal to spiketrain.t_start
Default: None</p>
</div></blockquote>
<p><strong>t_stop</strong> : Time Quantity (optional)</p>
<blockquote>
<div><p>End time of the interval used to compute the firing rate (included).
If None assumed equal to spiketrain.t_stop
Default: None</p>
</div></blockquote>
<p><strong>trim</strong> : bool</p>
<blockquote>
<div><p>if False, the output of the Fast Fourier Transformation being a longer
vector than the input vector by the size of the kernel is reduced back
to the original size of the considered time interval of the spiketrain
using the median of the kernel.
if True, only the region of the convolved signal is returned, where
there is complete overlap between kernel and spike train. This is
achieved by reducing the length of the output of the Fast Fourier
Transformation by a total of two times the size of the kernel, and
t_start and t_stop are adjusted.
Default: False</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>rate</strong> : neo.AnalogSignal</p>
<blockquote>
<div><p>Contains the rate estimation in unit hertz (Hz).
Has a property &#8216;rate.times&#8217; which contains the time axis of the rate
estimate. The unit of this property is the same as the resolution that
is given via the argument &#8216;sampling_period&#8217; to the function.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>TypeError:</strong></p>
<blockquote>
<div><p>If <cite>spiketrain</cite> is not an instance of <code class="xref py py-class docutils literal"><span class="pre">SpikeTrain</span></code> of Neo.
If <cite>sampling_period</cite> is not a time quantity.
If <cite>kernel</cite> is neither instance of <code class="xref py py-class docutils literal"><span class="pre">Kernel</span></code> or string &#8216;auto&#8217;.
If <cite>cutoff</cite> is neither float nor int.
If <cite>t_start</cite> and <cite>t_stop</cite> are neither None nor a time quantity.
If <cite>trim</cite> is not bool.</p>
</div></blockquote>
<p><strong>ValueError:</strong></p>
<blockquote class="last">
<div><p>If <cite>sampling_period</cite> is smaller than zero.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>..[1] H. Shimazaki, S. Shinomoto, J Comput Neurosci (2010) 29:171–182.</p>
</dd></dl>

<dl class="function">
<dt id="elephant.statistics.isi">
<code class="descclassname">elephant.statistics.</code><code class="descname">isi</code><span class="sig-paren">(</span><em>spiketrain</em>, <em>axis=-1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#isi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.isi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array containing the inter-spike intervals of the SpikeTrain.</p>
<p>Accepts a Neo SpikeTrain, a Quantity array, or a plain NumPy array.
If either a SpikeTrain or Quantity array is provided, the return value will
be a quantities array, otherwise a plain NumPy array. The units of
the quantities array will be the same as spiketrain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spiketrain</strong> : Neo SpikeTrain or Quantity array or NumPy ndarray</p>
<blockquote>
<div><p>The spike times.</p>
</div></blockquote>
<p><strong>axis</strong> : int, optional</p>
<blockquote>
<div><p>The axis along which the difference is taken.
Default is the last axis.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">NumPy array or quantities array.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="elephant.statistics.lv">
<code class="descclassname">elephant.statistics.</code><code class="descname">lv</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#lv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.lv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the measure of local variation LV for
a sequence of time intervals between events.</p>
<p>Given a vector v containing a sequence of intervals, the LV is
defined as:</p>
<p>.math $$ LV := frac{1}{N}sum_{i=1}^{N-1}</p>
<blockquote>
<div><dl class="docutils">
<dt>frac{3(isi_i-isi_{i+1})^2}</dt>
<dd>{(isi_i+isi_{i+1})^2} $$</dd>
</dl>
</div></blockquote>
<p>The LV is typically computed as a substitute for the classical
coefficient of variation for sequences of events which include
some (relatively slow) rate fluctuation.  As with the CV, LV=1 for
a sequence of intervals generated by a Poisson process.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>v</strong> : quantity array, numpy array or list</p>
<blockquote>
<div><p>Vector of consecutive time intervals</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>lvar</strong> : float</p>
<blockquote>
<div><p>The LV of the inter-spike interval of the input sequence.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>AttributeError :</strong></p>
<blockquote>
<div><p>If an empty list is specified, or if the sequence has less
than two entries, an AttributeError will be raised.</p>
</div></blockquote>
<p><strong>ValueError :</strong></p>
<blockquote class="last">
<div><p>Only vector inputs are supported.  If a matrix is passed to the
function a ValueError will be raised.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>..[1] Shinomoto, S., Shima, K., &amp; Tanji, J. (2003). Differences in spiking
patterns among cortical neurons. Neural Computation, 15, 2823–2842.</p>
</dd></dl>

<dl class="function">
<dt id="elephant.statistics.make_kernel">
<code class="descclassname">elephant.statistics.</code><code class="descname">make_kernel</code><span class="sig-paren">(</span><em>form</em>, <em>sigma</em>, <em>sampling_period</em>, <em>direction=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#make_kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.make_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates kernel functions for convolution.</p>
<p>Constructs a numeric linear convolution kernel of basic shape to be used
for data smoothing (linear low pass filtering) and firing rate estimation
from single trial or trial-averaged spike trains.</p>
<p>Exponential and alpha kernels may also be used to represent postynaptic
currents / potentials in a linear (current-based) model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>form</strong> : {&#8216;BOX&#8217;, &#8216;TRI&#8217;, &#8216;GAU&#8217;, &#8216;EPA&#8217;, &#8216;EXP&#8217;, &#8216;ALP&#8217;}</p>
<blockquote>
<div><p>Kernel form. Currently implemented forms are BOX (boxcar),
TRI (triangle), GAU (gaussian), EPA (epanechnikov), EXP (exponential),
ALP (alpha function). EXP and ALP are asymmetric kernel forms and
assume optional parameter <cite>direction</cite>.</p>
</div></blockquote>
<p><strong>sigma</strong> : Quantity</p>
<blockquote>
<div><p>Standard deviation of the distribution associated with kernel shape.
This parameter defines the time resolution of the kernel estimate
and makes different kernels comparable (cf. [1] for symmetric kernels).
This is used here as an alternative definition to the cut-off
frequency of the associated linear filter.</p>
</div></blockquote>
<p><strong>sampling_period</strong> : float</p>
<blockquote>
<div><p>Temporal resolution of input and output.</p>
</div></blockquote>
<p><strong>direction</strong> : {-1, 1}</p>
<blockquote>
<div><p>Asymmetric kernels have two possible directions.
The values are -1 or 1, default is 1. The
definition here is that for direction = 1 the
kernel represents the impulse response function
of the linear filter. Default value is 1.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>kernel</strong> : numpy.ndarray</p>
<blockquote>
<div><p>Array of kernel. The length of this array is always an odd
number to represent symmetric kernels such that the center bin
coincides with the median of the numeric array, i.e for a
triangle, the maximum will be at the center bin with equal
number of bins to the right and to the left.</p>
</div></blockquote>
<p><strong>norm</strong> : float</p>
<blockquote>
<div><p>For rate estimates. The kernel vector is normalized such that
the sum of all entries equals unity sum(kernel)=1. When
estimating rate functions from discrete spike data (0/1) the
additional parameter <cite>norm</cite> allows for the normalization to
rate in spikes per second.</p>
<p>For example:
<code class="docutils literal"><span class="pre">rate</span> <span class="pre">=</span> <span class="pre">norm</span> <span class="pre">*</span> <span class="pre">scipy.signal.lfilter(kernel,</span> <span class="pre">1,</span> <span class="pre">spike_data)</span></code></p>
</div></blockquote>
<p><strong>m_idx</strong> : int</p>
<blockquote class="last">
<div><p>Index of the numerically determined median (center of gravity)
of the kernel function.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../source/elephant.statistics.html#elephant.statistics.instantaneous_rate" title="elephant.statistics.instantaneous_rate"><code class="xref py py-obj docutils literal"><span class="pre">elephant.statistics.instantaneous_rate</span></code></a></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[R1]</a></td><td>Meier R, Egert U, Aertsen A, Nawrot MP, &#8220;FIND - a unified framework
for neural data analysis&#8221;; Neural Netw. 2008 Oct; 21(8):1085-93.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[R2]</a></td><td>Nawrot M, Aertsen A, Rotter S, &#8220;Single-trial estimation of neuronal
firing rates - from single neuron spike trains to population activity&#8221;;
J. Neurosci Meth 94: 81-92; 1999.</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>To obtain single trial rate function of trial one should use:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">norm</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">sua</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain trial-averaged spike train one should use:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">r_avg</span> <span class="o">=</span> <span class="n">norm</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fftconvolve</span><span class="p">(</span><span class="n">sua</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>where <cite>X</cite> is an array of shape <cite>(l,n)</cite>, <cite>n</cite> is the number of trials and
<cite>l</cite> is the length of each trial.</p>
</dd></dl>

<dl class="function">
<dt id="elephant.statistics.mean_firing_rate">
<code class="descclassname">elephant.statistics.</code><code class="descname">mean_firing_rate</code><span class="sig-paren">(</span><em>spiketrain</em>, <em>t_start=None</em>, <em>t_stop=None</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#mean_firing_rate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.mean_firing_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the firing rate of the SpikeTrain.</p>
<p>Accepts a Neo SpikeTrain, a Quantity array, or a plain NumPy array.
If either a SpikeTrain or Quantity array is provided, the return value will
be a quantities array, otherwise a plain NumPy array. The units of
the quantities array will be the inverse of the spiketrain.</p>
<p>The interval over which the firing rate is calculated can be optionally
controlled with <cite>t_start</cite> and <cite>t_stop</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spiketrain</strong> : Neo SpikeTrain or Quantity array or NumPy ndarray</p>
<blockquote>
<div><p>The spike times.</p>
</div></blockquote>
<p><strong>t_start</strong> : float or Quantity scalar, optional</p>
<blockquote>
<div><p>The start time to use for the interval.
If not specified, retrieved from the``t_start`
attribute of <cite>spiketrain</cite>.  If that is not present, default to
<cite>0</cite>.  Any value from <cite>spiketrain</cite> below this value is ignored.</p>
</div></blockquote>
<p><strong>t_stop</strong> : float or Quantity scalar, optional</p>
<blockquote>
<div><p>The stop time to use for the time points.
If not specified, retrieved from the <cite>t_stop</cite>
attribute of <cite>spiketrain</cite>.  If that is not present, default to
the maximum value of <cite>spiketrain</cite>.  Any value from
<cite>spiketrain</cite> above this value is ignored.</p>
</div></blockquote>
<p><strong>axis</strong> : int, optional</p>
<blockquote>
<div><p>The axis over which to do the calculation.
Default is <cite>None</cite>, do the calculation over the flattened array.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float, quantities scalar, NumPy array or quantities array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>TypeError</strong></p>
<blockquote class="last">
<div><p>If <cite>spiketrain</cite> is a NumPy array and <cite>t_start</cite> or <cite>t_stop</cite>
is a quantity scalar.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If <cite>spiketrain</cite> is a Quantity or Neo SpikeTrain and <cite>t_start</cite> or <cite>t_stop</cite>
are not, <cite>t_start</cite> and <cite>t_stop</cite> are assumed to have the same units as
<cite>spiketrain</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="elephant.statistics.nextpow2">
<code class="descclassname">elephant.statistics.</code><code class="descname">nextpow2</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#nextpow2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.nextpow2" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the smallest integral power of 2 that &gt;= x</p>
</dd></dl>

<dl class="function">
<dt id="elephant.statistics.oldfct_instantaneous_rate">
<code class="descclassname">elephant.statistics.</code><code class="descname">oldfct_instantaneous_rate</code><span class="sig-paren">(</span><em>spiketrain</em>, <em>sampling_period</em>, <em>form</em>, <em>sigma='auto'</em>, <em>t_start=None</em>, <em>t_stop=None</em>, <em>acausal=True</em>, <em>trim=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#oldfct_instantaneous_rate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.oldfct_instantaneous_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate instantaneous firing rate by kernel convolution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spiketrain: &#8216;neo.SpikeTrain&#8217;</strong></p>
<blockquote>
<div><p>Neo object that contains spike times, the unit of the time stamps
and t_start and t_stop of the spike train.</p>
</div></blockquote>
<p><strong>sampling_period</strong> : Quantity</p>
<blockquote>
<div><p>time stamp resolution of the spike times. the same resolution will
be assumed for the kernel</p>
</div></blockquote>
<p><strong>form</strong> : {&#8216;BOX&#8217;, &#8216;TRI&#8217;, &#8216;GAU&#8217;, &#8216;EPA&#8217;, &#8216;EXP&#8217;, &#8216;ALP&#8217;}</p>
<blockquote>
<div><p>Kernel form. Currently implemented forms are BOX (boxcar),
TRI (triangle), GAU (gaussian), EPA (epanechnikov), EXP (exponential),
ALP (alpha function). EXP and ALP are asymmetric kernel forms and
assume optional parameter <cite>direction</cite>.</p>
</div></blockquote>
<p><strong>sigma</strong> : string or Quantity</p>
<blockquote>
<div><p>Standard deviation of the distribution associated with kernel shape.
This parameter defines the time resolution of the kernel estimate
and makes different kernels comparable (cf. [1] for symmetric kernels).
This is used here as an alternative definition to the cut-off
frequency of the associated linear filter.
Default value is &#8216;auto&#8217;. In this case, the optimized kernel width for
the rate estimation is calculated according to [1]. Note that the
automatized calculation of the kernel width ONLY works for gaussian
kernel shapes!</p>
</div></blockquote>
<p><strong>t_start</strong> : Quantity (Optional)</p>
<blockquote>
<div><p>start time of the interval used to compute the firing rate, if None
assumed equal to spiketrain.t_start
Default:None</p>
</div></blockquote>
<p><strong>t_stop</strong> : Qunatity</p>
<blockquote>
<div><p>End time of the interval used to compute the firing rate (included).
If none assumed equal to spiketrain.t_stop
Default:None</p>
</div></blockquote>
<p><strong>acausal</strong> : bool</p>
<blockquote>
<div><p>if True, acausal filtering is used, i.e., the gravity center of the
filter function is aligned with the spike to convolve
Default:None</p>
</div></blockquote>
<p><strong>m_idx</strong> : int</p>
<blockquote>
<div><p>index of the value in the kernel function vector that corresponds
to its gravity center. this parameter is not mandatory for
symmetrical kernels but it is required when asymmetrical kernels
are to be aligned at their gravity center with the event times if None
is assumed to be the median value of the kernel support
Default : None</p>
</div></blockquote>
<p><strong>trim</strong> : bool</p>
<blockquote>
<div><p>if True, only the &#8216;valid&#8217; region of the convolved
signal are returned, i.e., the points where there
isn&#8217;t complete overlap between kernel and spike train
are discarded
NOTE: if True and an asymmetrical kernel is provided
the output will not be aligned with [t_start, t_stop]</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>rate</strong> : neo.AnalogSignal</p>
<blockquote>
<div><p>Contains the rate estimation in unit hertz (Hz).
Has a property &#8216;rate.times&#8217; which contains the time axis of the rate
estimate. The unit of this property is the same as the resolution that
is given as an argument to the function.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>TypeError:</strong></p>
<blockquote class="last">
<div><p>If argument value for the parameter <cite>sigma</cite> is not a quantity object
or string &#8216;auto&#8217;.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../source/elephant.statistics.html#elephant.statistics.make_kernel" title="elephant.statistics.make_kernel"><code class="xref py py-obj docutils literal"><span class="pre">elephant.statistics.make_kernel</span></code></a></p>
</div>
<p class="rubric">References</p>
<p>..[1] H. Shimazaki, S. Shinomoto, J Comput Neurosci (2010) 29:171–182.</p>
</dd></dl>

<dl class="function">
<dt id="elephant.statistics.sskernel">
<code class="descclassname">elephant.statistics.</code><code class="descname">sskernel</code><span class="sig-paren">(</span><em>spiketimes</em>, <em>tin=None</em>, <em>w=None</em>, <em>bootstrap=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#sskernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.sskernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates optimal fixed kernel bandwidth.</p>
<p>spiketimes: sequence of spike times (sorted to be ascending).</p>
<p>tin: (optional) time points at which the kernel bandwidth is to be estimated.</p>
<p>w: (optional) vector of kernel bandwidths. If specified, optimal
bandwidth is selected from this.</p>
<p>bootstrap (optional): whether to calculate the 95% confidence
interval. (default False)</p>
<p>Returns</p>
<p>A dictionary containing the following key value pairs:</p>
<p>&#8216;y&#8217;: estimated density,
&#8216;t&#8217;: points at which estimation was computed,
&#8216;optw&#8217;: optimal kernel bandwidth,
&#8216;w&#8217;: kernel bandwidths examined,
&#8216;C&#8217;: cost functions of w,
&#8216;confb95&#8217;: (lower bootstrap confidence level, upper bootstrap confidence level),
&#8216;yb&#8217;: bootstrap samples.</p>
<p>Ref: Shimazaki, Hideaki, and Shigeru Shinomoto. 2010. Kernel
Bandwidth Optimization in Spike Rate Estimation. Journal of
Computational Neuroscience 29 (1-2):
171-82. doi:10.1007/s10827-009-0180-4.</p>
</dd></dl>

<dl class="function">
<dt id="elephant.statistics.time_histogram">
<code class="descclassname">elephant.statistics.</code><code class="descname">time_histogram</code><span class="sig-paren">(</span><em>spiketrains</em>, <em>binsize</em>, <em>t_start=None</em>, <em>t_stop=None</em>, <em>output='counts'</em>, <em>binary=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/statistics.html#time_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.statistics.time_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Time Histogram of a list of <code class="xref py py-attr docutils literal"><span class="pre">neo.SpikeTrain</span></code> objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spiketrains</strong> : List of neo.SpikeTrain objects</p>
<blockquote>
<div><p>Spiketrains with a common time axis (same <cite>t_start</cite> and <cite>t_stop</cite>)</p>
</div></blockquote>
<p><strong>binsize</strong> : quantities.Quantity</p>
<blockquote>
<div><p>Width of the histogram&#8217;s time bins.</p>
</div></blockquote>
<p><strong>t_start, t_stop</strong> : Quantity (optional)</p>
<blockquote>
<div><p>Start and stop time of the histogram. Only events in the input
<cite>spiketrains</cite> falling between <cite>t_start</cite> and <cite>t_stop</cite> (both included)
are considered in the histogram. If <cite>t_start</cite> and/or <cite>t_stop</cite> are not
specified, the maximum <cite>t_start</cite> of all :attr:spiketrains is used as
<cite>t_start</cite>, and the minimum <cite>t_stop</cite> is used as <cite>t_stop</cite>.
Default: t_start = t_stop = None</p>
</div></blockquote>
<p><strong>output</strong> : str (optional)</p>
<blockquote>
<div><p>Normalization of the histogram. Can be one of:
* <cite>counts</cite>&#8216;<cite>: spike counts at each bin (as integer numbers)
* `mean</cite>: mean spike counts per spike train
* <cite>rate</cite>: mean spike rate per spike train. Like &#8216;mean&#8217;, but the</p>
<blockquote>
<div><p>counts are additionally normalized by the bin width.</p>
</div></blockquote>
</div></blockquote>
<p><strong>binary</strong> : bool (optional)</p>
<blockquote>
<div><p>If <strong>True</strong>, indicates whether all spiketrain objects should first
binned to a binary representation (using the <cite>BinnedSpikeTrain</cite> class
in the <cite>conversion</cite> module) and the calculation of the histogram is
based on this representation.
Note that the output is not binary, but a histogram of the converted,
binary representation.
Default: False</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>time_hist</strong> : neo.AnalogSignal</p>
<blockquote class="last">
<div><p>A neo.AnalogSignal object containing the histogram values.
<cite>AnalogSignal[j]</cite> is the histogram computed between
<cite>t_start + j * binsize</cite> and <cite>t_start + (j + 1) * binsize</cite>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../source/elephant.conversion.html#elephant.conversion.BinnedSpikeTrain" title="elephant.conversion.BinnedSpikeTrain"><code class="xref py py-obj docutils literal"><span class="pre">elephant.conversion.BinnedSpikeTrain</span></code></a></p>
</div>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014-2018, Elephant authors and contributors.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>