
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Unitary Event (UE) Analysis &#8212; Elephant 0.5.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/my-styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/elephant_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cumulant Based Inference of higher-order Correlation (CuBIC)" href="cubic.html" />
    <link rel="prev" title="Spike train correlation" href="spike_train_correlation.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/elephant_logo_sidebar.png"></span>
          Elephant</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Prerequisites / Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">Function Reference by Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide.html">Developers&#8217; guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc_style_guidelines.html">Documentation and style guideline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors and contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">This Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Unitary Event (UE) Analysis</a><ul>
<li><a class="reference internal" href="#synopsis">Synopsis</a></li>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#author-contributions">Author Contributions</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="spike_train_correlation.html" title="Previous Chapter: Spike train correlation"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Spike train c...</span>
    </a>
  </li>
  <li>
    <a href="cubic.html" title="Next Chapter: Cumulant Based Inference of higher-order Correlation (CuBIC)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Cumulant Base... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="module-elephant.unitary_event_analysis">
<span id="unitary-event-ue-analysis"></span><h1>Unitary Event (UE) Analysis<a class="headerlink" href="#module-elephant.unitary_event_analysis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<p>Unitary Event (UE) analysis is a statistical method that
analyzes excess spike correlation between simultaneously recorded neurons in a
time resolved manner by comparing the empirical spike coincidences to the
expected number based on the firing rates of the neurons see <a class="footnote-reference" href="#gruen99" id="id1">[1]</a>.</p>
</div>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>It has been proposed that cortical neurons organize dynamically into functional
groups (“cell assemblies”) by the temporal structure of their joint spiking
activity. The Unitary Events analysis method detects conspicuous patterns of
synchronous spike activity among simultaneously recorded single neurons. The
statistical significance of a pattern is evaluated by comparing the empirical
number of occurrences to the number expected given the firing rates of the
neurons. Key elements of the method are the proper formulation of the null
hypothesis and the derivation of the corresponding count distribution of
synchronous spike events used in the significance test. The analysis is
performed in a sliding window manner and yields a time-resolved measure of
significant spike synchrony.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p><span class="xref std std-ref">Tutorial on using Unitary Events</span></p>
<p>Run tutorial interactively:</p>
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/INM-6/elephant/enh/clean_ue?filepath=doc/ipynb/unitary_events.ipynb"><img alt="https://mybinder.org/badge.svg" src="https://mybinder.org/badge.svg" /></a>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils footnote" frame="void" id="gruen99" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Gruen S, Diesmann M, Grammont F, Riehle A, Aertsen A (1999) TITLE
J Neurosci Methods, 94(1): 67-79.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="gruen02a" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>Gruen S, Diesmann M, Aertsen A (2002) TITLE Neural Comput,
14(1): 43-80.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="gruen02b" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td>Gruen S, Diesmann M, Aertsen A (2002) TITLE Neural Comput,
14(1): 81-19.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="gruen03" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[4]</td><td>Gruen S, Riehle A, and Diesmann M (2003) Effect of cross-trial
nonstationarity on joint-spike events. Biological Cybernetics 88(5):335-351</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="gruen09" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[5]</td><td>Gruen S (2009) Data-driven significance estimation of precise
spike correlation. J Neurophysiology 101:1126-1140 (invited review).</td></tr>
</tbody>
</table>
</div>
<div class="section" id="author-contributions">
<h2>Author Contributions<a class="headerlink" href="#author-contributions" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li>Vahid Rostami (VH)</li>
<li>Sonja Gruen (SG)</li>
<li>Markus Diesmann (MD)</li>
</ul>
</div></blockquote>
<p>VH implemented the method, SG and MD provided input</p>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="elephant.unitary_event_analysis.gen_pval_anal">
<code class="descclassname">elephant.unitary_event_analysis.</code><code class="descname">gen_pval_anal</code><span class="sig-paren">(</span><em>mat</em>, <em>N</em>, <em>pattern_hash</em>, <em>method='analytic_TrialByTrial'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/unitary_event_analysis.html#gen_pval_anal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.unitary_event_analysis.gen_pval_anal" title="Permalink to this definition">¶</a></dt>
<dd><p>computes the expected coincidences and a function to calculate
p-value for given empirical coincidences</p>
<p>this function generate a poisson distribution with the expected
value calculated by mat. it returns a function which gets
the empirical coincidences, <cite>n_emp</cite>,  and calculates a p-value
as the area under the poisson distribution from <cite>n_emp</cite> to infinity</p>
</dd></dl>

<dl class="function">
<dt id="elephant.unitary_event_analysis.hash_from_pattern">
<code class="descclassname">elephant.unitary_event_analysis.</code><code class="descname">hash_from_pattern</code><span class="sig-paren">(</span><em>m</em>, <em>N</em>, <em>base=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/unitary_event_analysis.html#hash_from_pattern"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.unitary_event_analysis.hash_from_pattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate for a spike pattern or a matrix of spike patterns
(provide each pattern as a column) composed of N neurons a
unique number.</p>
</dd></dl>

<dl class="function">
<dt id="elephant.unitary_event_analysis.inverse_hash_from_pattern">
<code class="descclassname">elephant.unitary_event_analysis.</code><code class="descname">inverse_hash_from_pattern</code><span class="sig-paren">(</span><em>h</em>, <em>N</em>, <em>base=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/unitary_event_analysis.html#inverse_hash_from_pattern"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.unitary_event_analysis.inverse_hash_from_pattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the 0-1 spike patterns (matrix) from hash values</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inverse_hash_from_pattern</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="go">    array([[1, 1],</span>
<span class="go">           [1, 1],</span>
<span class="go">           [0, 1],</span>
<span class="go">           [0, 0]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="elephant.unitary_event_analysis.jointJ">
<code class="descclassname">elephant.unitary_event_analysis.</code><code class="descname">jointJ</code><span class="sig-paren">(</span><em>p_val</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/unitary_event_analysis.html#jointJ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.unitary_event_analysis.jointJ" title="Permalink to this definition">¶</a></dt>
<dd><p>Surprise measurement</p>
<p>logarithmic transformation of joint-p-value into surprise measure
for better visualization as the highly significant events are
indicated by very low joint-p-values</p>
</dd></dl>

<dl class="function">
<dt id="elephant.unitary_event_analysis.n_emp_mat">
<code class="descclassname">elephant.unitary_event_analysis.</code><code class="descname">n_emp_mat</code><span class="sig-paren">(</span><em>mat</em>, <em>N</em>, <em>pattern_hash</em>, <em>base=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/unitary_event_analysis.html#n_emp_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.unitary_event_analysis.n_emp_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the occurrences of spike coincidence patterns 
in the given spike trains.</p>
</dd></dl>

<dl class="function">
<dt id="elephant.unitary_event_analysis.n_emp_mat_sum_trial">
<code class="descclassname">elephant.unitary_event_analysis.</code><code class="descname">n_emp_mat_sum_trial</code><span class="sig-paren">(</span><em>mat</em>, <em>N</em>, <em>pattern_hash</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/unitary_event_analysis.html#n_emp_mat_sum_trial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.unitary_event_analysis.n_emp_mat_sum_trial" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates empirical number of observed patterns summed across trials</p>
</dd></dl>

<dl class="function">
<dt id="elephant.unitary_event_analysis.n_exp_mat">
<code class="descclassname">elephant.unitary_event_analysis.</code><code class="descname">n_exp_mat</code><span class="sig-paren">(</span><em>mat</em>, <em>N</em>, <em>pattern_hash</em>, <em>method='analytic'</em>, <em>n_surr=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/unitary_event_analysis.html#n_exp_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.unitary_event_analysis.n_exp_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the expected joint probability for each spike pattern</p>
</dd></dl>

<dl class="function">
<dt id="elephant.unitary_event_analysis.n_exp_mat_sum_trial">
<code class="descclassname">elephant.unitary_event_analysis.</code><code class="descname">n_exp_mat_sum_trial</code><span class="sig-paren">(</span><em>mat</em>, <em>N</em>, <em>pattern_hash</em>, <em>method='analytic_TrialByTrial'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/unitary_event_analysis.html#n_exp_mat_sum_trial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.unitary_event_analysis.n_exp_mat_sum_trial" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the expected joint probability
for each spike pattern sum over trials</p>
</dd></dl>

<dl class="function">
<dt id="elephant.unitary_event_analysis.unitary_event_analysis">
<code class="descclassname">elephant.unitary_event_analysis.</code><code class="descname">unitary_event_analysis</code><span class="sig-paren">(</span><em>data</em>, <em>bin_size</em>, <em>window_size</em>, <em>window_step</em>, <em>pattern_hash</em>, <em>method='analytic_TrialByTrial'</em>, <em>t_start=None</em>, <em>t_stop=None</em>, <em>binary=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/unitary_event_analysis.html#unitary_event_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.unitary_event_analysis.unitary_event_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the Unitary Event Analysis in a sliding window fashion.</p>
<p>#TODO: Describe the method</p>
<dl class="docutils">
<dt>data: list of lists of <cite>SpikeTrain</cite> objects</dt>
<dd>Contains the spike data to be analyzed. <cite>data</cite> is constructed such
that <cite>data[t][n]</cite> contains the <cite>SpikeTrain</cite> object that refers to
neuron <cite>n</cite> in trial <cite>t</cite>. For any trial <cite>t</cite> and any neuron <cite>n</cite>, the
<cite>SpikeTrain</cite> objects are assumed to share a common time axis.</dd>
<dt>bin_size: <cite>Quantity</cite> scalar (unit: time)</dt>
<dd>Size of bins for discretizing spike trains.</dd>
<dt>window_size: <cite>Quantity</cite> scalar (unit: time)</dt>
<dd>Size of the sliding analysis window.</dd>
<dt>window_step: <cite>Quantity</cite> scalar (unit: time)</dt>
<dd>Stepsize by the window is moved.</dd>
<dt>pattern_hash: list of integers</dt>
<dd>List of patterns to include in the analysis. Patterns are identified
by their hash values as returned by the function
<cite>hash_from_pattern</cite> (see also function <cite>inverse_hash_from_pattern</cite>).</dd>
<dt>method: string</dt>
<dd><p class="first">Method to calculate the Unitary Events.</p>
<ul class="simple">
<li>&#8216;analytic_TrialByTrial&#8217;: calculate the expectancy (analytically) on
each trial, then sum over all trials.</li>
<li>&#8216;analytic_TrialAverage&#8217;: calculate the expectancy by averaging over
trials (cf. Gruen et al. 2003).</li>
<li>&#8216;surrogate_TrialByTrial&#8217;: calculate the distribution of expected
coincidences by spike time randomization in each trial and sum over
trials.</li>
</ul>
<p class="last">Default: &#8216;analytic_trialByTrial&#8217;</p>
</dd>
<dt>t_start: None or Quantity scalar (unit time)</dt>
<dd><p class="first">The start time of the analysis. #TODO position of window?
If <strong>None</strong>, retrieved from the <cite>t_start</cite> attribute of the
<cite>SpikeTrain</cite> object.</p>
<p class="last">Default: None.</p>
</dd>
<dt>t_stop: None or Quantity scalar, optional</dt>
<dd><p class="first">The stop time of the analysis.
If <strong>None</strong>, retrieved from the <cite>t_stop</cite> attribute of the
<cite>SpikeTrain</cite> object.</p>
<p class="last">Default: None</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014-2018, Elephant authors and contributors.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>