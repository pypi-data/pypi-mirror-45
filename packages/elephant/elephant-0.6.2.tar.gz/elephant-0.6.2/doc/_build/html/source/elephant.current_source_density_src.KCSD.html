
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>elephant.current_source_density_src.KCSD module &#8212; Elephant 0.5.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/my-styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/elephant_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/elephant_logo_sidebar.png"></span>
          Elephant</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Prerequisites / Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Function Reference by Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide.html">Developers&#8217; guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc_style_guidelines.html">Documentation and style guideline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors and contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">This Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">elephant.current_source_density_src.KCSD module</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="module-elephant.current_source_density_src.KCSD">
<span id="elephant-current-source-density-src-kcsd-module"></span><h1>elephant.current_source_density_src.KCSD module<a class="headerlink" href="#module-elephant.current_source_density_src.KCSD" title="Permalink to this headline">¶</a></h1>
<p>This script is used to generate Current Source Density Estimates, using the
kCSD method Jan et.al (2012).
This was written by :
[1]Chaitanya Chintaluri,
[2]Michal Czerwinski,
Laboratory of Neuroinformatics,
Nencki Institute of Exprimental Biology, Warsaw.
KCSD1D[1][2], KCSD2D[1], KCSD3D[1], MoIKCSD[1]</p>
<dl class="class">
<dt id="elephant.current_source_density_src.KCSD.CSD">
<em class="property">class </em><code class="descclassname">elephant.current_source_density_src.KCSD.</code><code class="descname">CSD</code><span class="sig-paren">(</span><em>ele_pos</em>, <em>pots</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#CSD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.CSD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>CSD - The base class for KCSD methods.</p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.CSD.sanity">
<code class="descname">sanity</code><span class="sig-paren">(</span><em>true_csd</em>, <em>pos_csd</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#CSD.sanity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.CSD.sanity" title="Permalink to this definition">¶</a></dt>
<dd><p>Useful for comparing TrueCSD with reconstructed CSD. Computes, the RMS error
between the true_csd and the reconstructed csd at pos_csd using the
method defined.
Parameters
&#8212;&#8212;&#8212;-
true_csd : csd values used to generate potentials
pos_csd : csd estimatation from the method
Returns
&#8212;&#8212;-
RMSE : root mean squared difference</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.CSD.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><em>ele_pos</em>, <em>pots</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#CSD.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.CSD.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic checks to see if inputs are okay</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ele_pos</strong> : numpy array</p>
<blockquote>
<div><p>positions of electrodes</p>
</div></blockquote>
<p><strong>pots</strong> : numpy array</p>
<blockquote class="last">
<div><p>potentials measured by electrodes</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="elephant.current_source_density_src.KCSD.KCSD">
<em class="property">class </em><code class="descclassname">elephant.current_source_density_src.KCSD.</code><code class="descname">KCSD</code><span class="sig-paren">(</span><em>ele_pos</em>, <em>pots</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#elephant.current_source_density_src.KCSD.CSD" title="elephant.current_source_density_src.KCSD.CSD"><code class="xref py py-class docutils literal"><span class="pre">elephant.current_source_density_src.KCSD.CSD</span></code></a></p>
<p>KCSD - The base class for all the KCSD variants.
This estimates the Current Source Density, for a given configuration of
electrod positions and recorded potentials, electrodes.
The method implented here is based on the original paper
by Jan Potworowski et.al. 2012.</p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD.compute_cverror">
<code class="descname">compute_cverror</code><span class="sig-paren">(</span><em>lambd</em>, <em>index_generator</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD.compute_cverror"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD.compute_cverror" title="Permalink to this definition">¶</a></dt>
<dd><p>Useful for Cross validation error calculations
Parameters
&#8212;&#8212;&#8212;-
lambd : float
index_generator : list
Returns
&#8212;&#8212;-
err : float</p>
<blockquote>
<div>the sum of the error computed.</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD.create_lookup">
<code class="descname">create_lookup</code><span class="sig-paren">(</span><em>dist_table_density=20</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD.create_lookup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD.create_lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a table for easy potential estimation from CSD.
Updates and Returns the potentials due to a
given basis source like a lookup
table whose shape=(dist_table_density,)
Parameters
&#8212;&#8212;&#8212;-
dist_table_density : int</p>
<blockquote>
<div>number of distance values at which potentials are computed.
Default 100</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD.cross_validate">
<code class="descname">cross_validate</code><span class="sig-paren">(</span><em>lambdas=None</em>, <em>Rs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD.cross_validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD.cross_validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Method defines the cross validation.
By default only cross_validates over lambda,
When no argument is passed, it takes
lambdas = np.logspace(-2,-25,25,base=10.)
and Rs = np.array(self.R).flatten()
otherwise pass necessary numpy arrays
Parameters
&#8212;&#8212;&#8212;-
lambdas : numpy array
Rs : numpy array
Returns
&#8212;&#8212;-
R : post cross validation
Lambda : post cross validation</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD.method">
<code class="descname">method</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD.method"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD.method" title="Permalink to this definition">¶</a></dt>
<dd><p>Actual sequence of methods called for KCSD
Defines:
self.k_pot and self.k_interp_cross matrices
Parameters
&#8212;&#8212;&#8212;-
None</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD.parameters">
<code class="descname">parameters</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD.parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Defining the default values of the method passed as kwargs
Parameters
&#8212;&#8212;&#8212;-
<a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs</p>
<blockquote>
<div>Same as those passed to initialize the Class</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD.process_estimate">
<code class="descname">process_estimate</code><span class="sig-paren">(</span><em>estimation</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD.process_estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD.process_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function used to rearrange estimation according to dimension, to be
used by the fuctions values
Parameters
&#8212;&#8212;&#8212;-
estimation : np.array
Returns
&#8212;&#8212;-
estimation : np.array</p>
<blockquote>
<div>estimated quantity of shape (ngx, ngy, ngz, nt)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD.update_R">
<code class="descname">update_R</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD.update_R"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD.update_R" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the width of the basis fuction - Used in Cross validation
Parameters
&#8212;&#8212;&#8212;-
R : float</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD.update_b_interp_pot">
<code class="descname">update_b_interp_pot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD.update_b_interp_pot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD.update_b_interp_pot" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the matrix of potentials generated by every source
basis function at every position in the interpolated space.
Updates b_interp_pot
Updates k_interp_pot
Parameters
&#8212;&#8212;&#8212;-
None</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD.update_b_pot">
<code class="descname">update_b_pot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD.update_b_pot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD.update_b_pot" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the b_pot  - array is (#_basis_sources, #_electrodes)
Updates the  k_pot - array is (#_electrodes, #_electrodes) K(x,x&#8217;)
Eq9,Jan2012
Calculates b_pot - matrix containing the values of all
the potential basis functions in all the electrode positions
(essential for calculating the cross_matrix).
Parameters
&#8212;&#8212;&#8212;-
None</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD.update_b_src">
<code class="descname">update_b_src</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD.update_b_src"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD.update_b_src" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the b_src in the shape of (#_est_pts, #_basis_sources)
Updates the k_interp_cross - K_t(x,y) Eq17
Calculate b_src - matrix containing containing the values of
all the source basis functions in all the points at which we want to
calculate the solution (essential for calculating the cross_matrix)
Parameters
&#8212;&#8212;&#8212;-
None</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD.update_lambda">
<code class="descname">update_lambda</code><span class="sig-paren">(</span><em>lambd</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD.update_lambda"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD.update_lambda" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the lambda parameter of regularization, Used in Cross validation
Parameters
&#8212;&#8212;&#8212;-
lambd : float</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD.values">
<code class="descname">values</code><span class="sig-paren">(</span><em>estimate='CSD'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD.values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the values of the quantity of interest
Parameters
&#8212;&#8212;&#8212;-
estimate : &#8216;CSD&#8217; or &#8216;POT&#8217;</p>
<blockquote>
<div>What quantity is to be estimated
Defaults to &#8216;CSD&#8217;</div></blockquote>
<dl class="docutils">
<dt>estimation <span class="classifier-delimiter">:</span> <span class="classifier">np.array</span></dt>
<dd>estimated quantity of shape (ngx, ngy, ngz, nt)</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="elephant.current_source_density_src.KCSD.KCSD1D">
<em class="property">class </em><code class="descclassname">elephant.current_source_density_src.KCSD.</code><code class="descname">KCSD1D</code><span class="sig-paren">(</span><em>ele_pos</em>, <em>pots</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#elephant.current_source_density_src.KCSD.KCSD" title="elephant.current_source_density_src.KCSD.KCSD"><code class="xref py py-class docutils literal"><span class="pre">elephant.current_source_density_src.KCSD.KCSD</span></code></a></p>
<p>KCSD1D - The 1D variant for the Kernel Current Source Density method.
This estimates the Current Source Density, for a given configuration of
electrod positions and recorded potentials, in the case of 1D recording
electrodes (laminar probes). The method implented here is based on the
original paper by Jan Potworowski et.al. 2012.</p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD1D.create_src_dist_tables">
<code class="descname">create_src_dist_tables</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD1D.create_src_dist_tables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD1D.create_src_dist_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates distance tables between sources, electrode and estm points
Parameters
&#8212;&#8212;&#8212;-
None</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD1D.estimate_at">
<code class="descname">estimate_at</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD1D.estimate_at"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD1D.estimate_at" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines locations where the estimation is wanted
Defines:
self.n_estm = self.estm_x.size
self.ngx = self.estm_x.shape
self.estm_x : Locations at which CSD is requested.
Parameters
&#8212;&#8212;&#8212;-
None</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD1D.forward_model">
<code class="descname">forward_model</code><span class="sig-paren">(</span><em>x</em>, <em>R</em>, <em>h</em>, <em>sigma</em>, <em>src_type</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD1D.forward_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD1D.forward_model" title="Permalink to this definition">¶</a></dt>
<dd><p>FWD model functions
Evaluates potential at point (x,0) by a basis source located at (0,0)
Eq 26 kCSD by Jan,2012
Parameters
&#8212;&#8212;&#8212;-
x : float
R : float
h : float
sigma : float
src_type : basis_1D.key
Returns
&#8212;&#8212;-
pot : float</p>
<blockquote>
<div>value of potential at specified distance from the source</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD1D.int_pot_1D">
<code class="descname">int_pot_1D</code><span class="sig-paren">(</span><em>xp</em>, <em>x</em>, <em>R</em>, <em>h</em>, <em>basis_func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD1D.int_pot_1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD1D.int_pot_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>FWD model function.
Returns contribution of a point xp,yp, belonging to a basis source
support centered at (0,0) to the potential measured at (x,0),
integrated over xp,yp gives the potential generated by a
basis source element centered at (0,0) at point (x,0)
Eq 26 kCSD by Jan,2012</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>xp</strong> : floats or np.arrays</p>
<blockquote>
<div><p>point or set of points where function should be calculated</p>
</div></blockquote>
<p><strong>x</strong> :  float</p>
<blockquote>
<div><p>position at which potential is being measured</p>
</div></blockquote>
<p><strong>R</strong> : float</p>
<blockquote>
<div><p>The size of the basis function</p>
</div></blockquote>
<p><strong>h</strong> : float</p>
<blockquote>
<div><p>thickness of slice</p>
</div></blockquote>
<p><strong>basis_func</strong> : method</p>
<blockquote>
<div><p>Fuction of the basis source</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>pot</strong> : float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD1D.place_basis">
<code class="descname">place_basis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD1D.place_basis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD1D.place_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Places basis sources of the defined type.
Checks if a given source_type is defined, if so then defines it
self.basis, This function gives locations of the basis sources,
Defines
source_type : basis_fuctions.basis_1D.keys()
self.R based on R_init
self.dist_max as maximum distance between electrode and basis
self.nsx = self.src_x.shape
self.src_x : Locations at which basis sources are placed.
Parameters
&#8212;&#8212;&#8212;-
None</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="elephant.current_source_density_src.KCSD.KCSD2D">
<em class="property">class </em><code class="descclassname">elephant.current_source_density_src.KCSD.</code><code class="descname">KCSD2D</code><span class="sig-paren">(</span><em>ele_pos</em>, <em>pots</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#elephant.current_source_density_src.KCSD.KCSD" title="elephant.current_source_density_src.KCSD.KCSD"><code class="xref py py-class docutils literal"><span class="pre">elephant.current_source_density_src.KCSD.KCSD</span></code></a></p>
<p>KCSD2D - The 2D variant for the Kernel Current Source Density method.
This estimates the Current Source Density, for a given configuration of
electrod positions and recorded potentials, in the case of 2D recording
electrodes. The method implented here is based on the original paper
by Jan Potworowski et.al. 2012.</p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD2D.create_src_dist_tables">
<code class="descname">create_src_dist_tables</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD2D.create_src_dist_tables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD2D.create_src_dist_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates distance tables between sources, electrode and estm points
Parameters
&#8212;&#8212;&#8212;-
None</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD2D.estimate_at">
<code class="descname">estimate_at</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD2D.estimate_at"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD2D.estimate_at" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines locations where the estimation is wanted
Defines:
self.n_estm = self.estm_x.size
self.ngx, self.ngy = self.estm_x.shape
self.estm_x, self.estm_y : Locations at which CSD is requested.
Parameters
&#8212;&#8212;&#8212;-
None</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD2D.forward_model">
<code class="descname">forward_model</code><span class="sig-paren">(</span><em>x</em>, <em>R</em>, <em>h</em>, <em>sigma</em>, <em>src_type</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD2D.forward_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD2D.forward_model" title="Permalink to this definition">¶</a></dt>
<dd><p>FWD model functions
Evaluates potential at point (x,0) by a basis source located at (0,0)
Eq 22 kCSD by Jan,2012
Parameters
&#8212;&#8212;&#8212;-
x : float
R : float
h : float
sigma : float
src_type : basis_2D.key
Returns
&#8212;&#8212;-
pot : float</p>
<blockquote>
<div>value of potential at specified distance from the source</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD2D.int_pot_2D">
<code class="descname">int_pot_2D</code><span class="sig-paren">(</span><em>xp</em>, <em>yp</em>, <em>x</em>, <em>R</em>, <em>h</em>, <em>basis_func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD2D.int_pot_2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD2D.int_pot_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>FWD model function.
Returns contribution of a point xp,yp, belonging to a basis source
support centered at (0,0) to the potential measured at (x,0),
integrated over xp,yp gives the potential generated by a
basis source element centered at (0,0) at point (x,0)
Parameters
&#8212;&#8212;&#8212;-
xp, yp : floats or np.arrays</p>
<blockquote>
<div>point or set of points where function should be calculated</div></blockquote>
<dl class="docutils">
<dt>x <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>position at which potential is being measured</dd>
<dt>R <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The size of the basis function</dd>
<dt>h <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>thickness of slice</dd>
<dt>basis_func <span class="classifier-delimiter">:</span> <span class="classifier">method</span></dt>
<dd>Fuction of the basis source</dd>
</dl>
<p>pot : float</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD2D.place_basis">
<code class="descname">place_basis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD2D.place_basis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD2D.place_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Places basis sources of the defined type.
Checks if a given source_type is defined, if so then defines it
self.basis, This function gives locations of the basis sources,
Defines
source_type : basis_fuctions.basis_2D.keys()
self.R based on R_init
self.dist_max as maximum distance between electrode and basis
self.nsx, self.nsy = self.src_x.shape
self.src_x, self.src_y : Locations at which basis sources are placed.
Parameters
&#8212;&#8212;&#8212;-
None</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="elephant.current_source_density_src.KCSD.KCSD3D">
<em class="property">class </em><code class="descclassname">elephant.current_source_density_src.KCSD.</code><code class="descname">KCSD3D</code><span class="sig-paren">(</span><em>ele_pos</em>, <em>pots</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#elephant.current_source_density_src.KCSD.KCSD" title="elephant.current_source_density_src.KCSD.KCSD"><code class="xref py py-class docutils literal"><span class="pre">elephant.current_source_density_src.KCSD.KCSD</span></code></a></p>
<p>KCSD3D - The 3D variant for the Kernel Current Source Density method.
This estimates the Current Source Density, for a given configuration of
electrod positions and recorded potentials, in the case of 2D recording
electrodes. The method implented here is based on the original paper
by Jan Potworowski et.al. 2012.</p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD3D.create_src_dist_tables">
<code class="descname">create_src_dist_tables</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD3D.create_src_dist_tables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD3D.create_src_dist_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates distance tables between sources, electrode and estm points
Parameters
&#8212;&#8212;&#8212;-
None</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD3D.estimate_at">
<code class="descname">estimate_at</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD3D.estimate_at"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD3D.estimate_at" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines locations where the estimation is wanted
Defines:
self.n_estm = self.estm_x.size
self.ngx, self.ngy, self.ngz = self.estm_x.shape
self.estm_x, self.estm_y, self.estm_z : Pts. at which CSD is requested
Parameters
&#8212;&#8212;&#8212;-
None</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD3D.forward_model">
<code class="descname">forward_model</code><span class="sig-paren">(</span><em>x</em>, <em>R</em>, <em>h</em>, <em>sigma</em>, <em>src_type</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD3D.forward_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD3D.forward_model" title="Permalink to this definition">¶</a></dt>
<dd><p>FWD model functions
Evaluates potential at point (x,0) by a basis source located at (0,0)
Utlizies sk monaco monte carlo method if available, otherwise defaults
to scipy integrate
Parameters
&#8212;&#8212;&#8212;-
x : float
R : float
h : float
sigma : float
src_type : basis_3D.key
Returns
&#8212;&#8212;-
pot : float</p>
<blockquote>
<div>value of potential at specified distance from the source</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD3D.int_pot_3D">
<code class="descname">int_pot_3D</code><span class="sig-paren">(</span><em>xp</em>, <em>yp</em>, <em>zp</em>, <em>x</em>, <em>R</em>, <em>h</em>, <em>basis_func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD3D.int_pot_3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD3D.int_pot_3D" title="Permalink to this definition">¶</a></dt>
<dd><p>FWD model function.
Returns contribution of a point xp,yp, belonging to a basis source
support centered at (0,0) to the potential measured at (x,0),
integrated over xp,yp gives the potential generated by a
basis source element centered at (0,0) at point (x,0)
Parameters
&#8212;&#8212;&#8212;-
xp, yp, zp : floats or np.arrays</p>
<blockquote>
<div>point or set of points where function should be calculated</div></blockquote>
<dl class="docutils">
<dt>x <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>position at which potential is being measured</dd>
<dt>R <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The size of the basis function</dd>
<dt>h <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>thickness of slice</dd>
<dt>basis_func <span class="classifier-delimiter">:</span> <span class="classifier">method</span></dt>
<dd>Fuction of the basis source</dd>
</dl>
<p>pot : float</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD3D.int_pot_3D_mc">
<code class="descname">int_pot_3D_mc</code><span class="sig-paren">(</span><em>xyz</em>, <em>x</em>, <em>R</em>, <em>h</em>, <em>basis_func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD3D.int_pot_3D_mc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD3D.int_pot_3D_mc" title="Permalink to this definition">¶</a></dt>
<dd><p>The same as int_pot_3D, just different input: x,y,z &lt;&#8211; xyz (tuple)
FWD model function, using Monte Carlo Method of integration
Returns contribution of a point xp,yp, belonging to a basis source
support centered at (0,0) to the potential measured at (x,0),
integrated over xp,yp gives the potential generated by a
basis source element centered at (0,0) at point (x,0)
Parameters
&#8212;&#8212;&#8212;-
xp, yp, zp : floats or np.arrays</p>
<blockquote>
<div>point or set of points where function should be calculated</div></blockquote>
<dl class="docutils">
<dt>x <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>position at which potential is being measured</dd>
<dt>R <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The size of the basis function</dd>
<dt>h <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>thickness of slice</dd>
<dt>basis_func <span class="classifier-delimiter">:</span> <span class="classifier">method</span></dt>
<dd>Fuction of the basis source</dd>
</dl>
<p>pot : float</p>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.KCSD3D.place_basis">
<code class="descname">place_basis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#KCSD3D.place_basis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.KCSD3D.place_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Places basis sources of the defined type.
Checks if a given source_type is defined, if so then defines it
self.basis, This function gives locations of the basis sources,
Defines
source_type : basis_fuctions.basis_2D.keys()
self.R based on R_init
self.dist_max as maximum distance between electrode and basis
self.nsx, self.nsy, self.nsz = self.src_x.shape
self.src_x, self.src_y, self.src_z : Locations at which basis sources are placed.
Parameters
&#8212;&#8212;&#8212;-
None</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="elephant.current_source_density_src.KCSD.MoIKCSD">
<em class="property">class </em><code class="descclassname">elephant.current_source_density_src.KCSD.</code><code class="descname">MoIKCSD</code><span class="sig-paren">(</span><em>ele_pos</em>, <em>pots</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#MoIKCSD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.MoIKCSD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#elephant.current_source_density_src.KCSD.KCSD2D" title="elephant.current_source_density_src.KCSD.KCSD2D"><code class="xref py py-class docutils literal"><span class="pre">elephant.current_source_density_src.KCSD.KCSD2D</span></code></a></p>
<p>MoIKCSD - CSD while including the forward modeling effects of saline.</p>
<p>This estimates the Current Source Density, for a given configuration of
electrod positions and recorded potentials, in the case of 2D recording
electrodes from an MEA electrode plane using the Method of Images.
The method implented here is based on kCSD method by Jan Potworowski
et.al. 2012, which was extended in Ness, Chintaluri 2015 for MEA.</p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.MoIKCSD.forward_model">
<code class="descname">forward_model</code><span class="sig-paren">(</span><em>x</em>, <em>R</em>, <em>h</em>, <em>sigma</em>, <em>src_type</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#MoIKCSD.forward_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.MoIKCSD.forward_model" title="Permalink to this definition">¶</a></dt>
<dd><p>FWD model functions
Evaluates potential at point (x,0) by a basis source located at (0,0)
Eq 22 kCSD by Jan,2012
Parameters
&#8212;&#8212;&#8212;-
x : float
R : float
h : float
sigma : float
src_type : basis_2D.key
Returns
&#8212;&#8212;-
pot : float</p>
<blockquote>
<div>value of potential at specified distance from the source</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="elephant.current_source_density_src.KCSD.MoIKCSD.int_pot_2D_moi">
<code class="descname">int_pot_2D_moi</code><span class="sig-paren">(</span><em>xp</em>, <em>yp</em>, <em>x</em>, <em>R</em>, <em>h</em>, <em>basis_func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/current_source_density_src/KCSD.html#MoIKCSD.int_pot_2D_moi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.current_source_density_src.KCSD.MoIKCSD.int_pot_2D_moi" title="Permalink to this definition">¶</a></dt>
<dd><p>FWD model function. Incorporates the Method of Images.
Returns contribution of a point xp,yp, belonging to a basis source
support centered at (0,0) to the potential measured at (x,0),
integrated over xp,yp gives the potential generated by a
basis source element centered at (0,0) at point (x,0)
#Eq 20, Ness(2015)
Parameters
&#8212;&#8212;&#8212;-
xp, yp : floats or np.arrays</p>
<blockquote>
<div>point or set of points where function should be calculated</div></blockquote>
<dl class="docutils">
<dt>x <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>position at which potential is being measured</dd>
<dt>R <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The size of the basis function</dd>
<dt>h <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>thickness of slice</dd>
<dt>basis_func <span class="classifier-delimiter">:</span> <span class="classifier">method</span></dt>
<dd>Fuction of the basis source</dd>
</dl>
<p>pot : float</p>
</dd></dl>

</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014-2018, Elephant authors and contributors.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>