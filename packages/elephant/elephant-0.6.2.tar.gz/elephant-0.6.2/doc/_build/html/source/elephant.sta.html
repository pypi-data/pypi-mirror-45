
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>elephant.sta module &#8212; Elephant 0.5.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/my-styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/elephant_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/elephant_logo_sidebar.png"></span>
          Elephant</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Prerequisites / Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Function Reference by Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide.html">Developers&#8217; guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc_style_guidelines.html">Documentation and style guideline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors and contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">This Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">elephant.sta module</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="module-elephant.sta">
<span id="elephant-sta-module"></span><h1>elephant.sta module<a class="headerlink" href="#module-elephant.sta" title="Permalink to this headline">¶</a></h1>
<p>Functions to calculate spike-triggered average and spike-field coherence of
analog signals.</p>
<dl class="function">
<dt id="elephant.sta.spike_field_coherence">
<code class="descclassname">elephant.sta.</code><code class="descname">spike_field_coherence</code><span class="sig-paren">(</span><em>signal</em>, <em>spiketrain</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/sta.html#spike_field_coherence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.sta.spike_field_coherence" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the spike-field coherence between a analog signal(s) and a
(binned) spike train.</p>
<p>The current implementation makes use of scipy.signal.coherence(). Additional
kwargs will will be directly forwarded to scipy.signal.coherence(),
except for the axis parameter and the sampling frequency, which will be
extracted from the input signals.</p>
<p>The spike_field_coherence function receives an analog signal array and
either a binned spike train or a spike train containing the original spike
times. In case of original spike times the spike train is binned according
to the sampling rate of the analog signal array.</p>
<p>The AnalogSignal object can contain one or multiple signal traces. In case
of multiple signal traces, the spike field coherence is calculated
individually for each signal trace and the spike train.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>signal</strong> : neo AnalogSignal object</p>
<blockquote>
<div><p>&#8216;signal&#8217; contains n analog signals.</p>
</div></blockquote>
<p><strong>spiketrain</strong> : SpikeTrain or BinnedSpikeTrain</p>
<blockquote>
<div><p>Single spike train to perform the analysis on. The binsize of the
binned spike train must match the sampling_rate of signal.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>coherence</strong> : complex Quantity array</p>
<blockquote>
<div><p>contains the coherence values calculated for each analog signal trace
in combination with the spike train. The first dimension corresponds to
the frequency, the second to the number of the signal trace.</p>
</div></blockquote>
<p><strong>frequencies</strong> : Quantity array</p>
<blockquote class="last">
<div><p>contains the frequency values corresponding to the first dimension of
the &#8216;coherence&#8217; array</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="elephant.sta.spike_triggered_average">
<code class="descclassname">elephant.sta.</code><code class="descname">spike_triggered_average</code><span class="sig-paren">(</span><em>signal</em>, <em>spiketrains</em>, <em>window</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/elephant/sta.html#spike_triggered_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#elephant.sta.spike_triggered_average" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the spike-triggered averages of analog signals in a time window
relative to the spike times of a corresponding spiketrain for multiple
signals each. The function receives n analog signals and either one or
n spiketrains. In case it is one spiketrain this one is muliplied n-fold
and used for each of the n analog signals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>signal</strong> : neo AnalogSignal object</p>
<blockquote>
<div><p>&#8216;signal&#8217; contains n analog signals.</p>
</div></blockquote>
<p><strong>spiketrains</strong> : one SpikeTrain or one numpy ndarray or a list of n of either of these.</p>
<blockquote>
<div><p>&#8216;spiketrains&#8217; contains the times of the spikes in the spiketrains.</p>
</div></blockquote>
<p><strong>window</strong> : tuple of 2 Quantity objects with dimensions of time.</p>
<blockquote>
<div><p>&#8216;window&#8217; is the start time and the stop time, relative to a spike, of
the time interval for signal averaging.
If the window size is not a multiple of the sampling interval of the 
signal the window will be extended to the next multiple.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result_sta</strong> : neo AnalogSignal object</p>
<blockquote class="last">
<div><p>&#8216;result_sta&#8217; contains the spike-triggered averages of each of the
analog signals with respect to the spikes in the corresponding
spiketrains. The length of &#8216;result_sta&#8217; is calculated as the number
of bins from the given start and stop time of the averaging interval
and the sampling rate of the analog signal. If for an analog signal
no spike was either given or all given spikes had to be ignored
because of a too large averaging interval, the corresponding returned
analog signal has all entries as nan. The number of used spikes and
unused spikes for each analog signal are returned as annotations to 
the returned AnalogSignal object.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">neo</span><span class="o">.</span><span class="n">AnalogSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;mV&#39;</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">10</span><span class="o">/</span><span class="n">ms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stavg</span> <span class="o">=</span> <span class="n">spike_triggered_average</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="p">[</span><span class="n">spiketrain1</span><span class="p">,</span> <span class="n">spiketrain2</span><span class="p">],</span>
<span class="gp">... </span>                                <span class="p">(</span><span class="o">-</span><span class="mi">5</span> <span class="o">*</span> <span class="n">ms</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">ms</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014-2018, Elephant authors and contributors.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>