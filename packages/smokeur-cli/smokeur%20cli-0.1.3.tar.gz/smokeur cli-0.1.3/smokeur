#! /usr/bin/env python
"""
Smokeur CLI
"""
import os
import sys

import requests

try:
    SMOKEUR_SERVER = os.environ['SMOKEUR_SERVER']
except KeyError:
    print("Please set 'SMOKEUR_SERVER' environment variable before "
          "using this tool.")
    sys.exit(1)


def upload_file():
    """Upload a file to Smokeur"""
    try:
        file_name = sys.argv[1]
    except IndexError:
        print('You have to give the file path to upload.\n'
              'e.g.:\n'
              'smokeur somefile.jpg')
        sys.exit(1)

    with open(file_name, 'rb') as file:
        data = {
            'file': file
        }

        response = requests.post(
            url=SMOKEUR_SERVER,
            files=data,
        )

    if response.status_code == 200:
        print(response.json())
    else:
        print(response.reason)


if __name__ == '__main__':
    upload_file()
