% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\usepackage[utf8]{inputenc}
\DeclareUnicodeCharacter{00A0}{\nobreakspace}
\usepackage[T1]{fontenc}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage{longtable}
\usepackage{sphinx}
\usepackage{multirow}


\title{PhreeqPy Documentation}
\date{February 08, 2013}
\release{0.2}
\author{Mike MÃ¼ller\\\\ http://www.hydrocomputing.com}
\newcommand{\sphinxlogo}{}
\renewcommand{\releasename}{Release}
\makeindex

\makeatletter
\def\PYG@reset{\let\PYG@it=\relax \let\PYG@bf=\relax%
    \let\PYG@ul=\relax \let\PYG@tc=\relax%
    \let\PYG@bc=\relax \let\PYG@ff=\relax}
\def\PYG@tok#1{\csname PYG@tok@#1\endcsname}
\def\PYG@toks#1+{\ifx\relax#1\empty\else%
    \PYG@tok{#1}\expandafter\PYG@toks\fi}
\def\PYG@do#1{\PYG@bc{\PYG@tc{\PYG@ul{%
    \PYG@it{\PYG@bf{\PYG@ff{#1}}}}}}}
\def\PYG#1#2{\PYG@reset\PYG@toks#1+\relax+\PYG@do{#2}}

\expandafter\def\csname PYG@tok@gd\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PYG@tok@gu\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PYG@tok@gt\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.25,0.82}{##1}}}
\expandafter\def\csname PYG@tok@gs\endcsname{\let\PYG@bf=\textbf}
\expandafter\def\csname PYG@tok@gr\endcsname{\def\PYG@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PYG@tok@cm\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@vg\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@m\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@mh\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@cs\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}\def\PYG@bc##1{\setlength{\fboxsep}{0pt}\colorbox[rgb]{1.00,0.94,0.94}{\strut ##1}}}
\expandafter\def\csname PYG@tok@ge\endcsname{\let\PYG@it=\textit}
\expandafter\def\csname PYG@tok@vc\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@il\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@go\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.19,0.19,0.19}{##1}}}
\expandafter\def\csname PYG@tok@cp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@gi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PYG@tok@gh\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PYG@tok@ni\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.84,0.33,0.22}{##1}}}
\expandafter\def\csname PYG@tok@nl\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.13,0.44}{##1}}}
\expandafter\def\csname PYG@tok@nn\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\expandafter\def\csname PYG@tok@no\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.38,0.68,0.84}{##1}}}
\expandafter\def\csname PYG@tok@na\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@nb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@nc\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\expandafter\def\csname PYG@tok@nd\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.33,0.33,0.33}{##1}}}
\expandafter\def\csname PYG@tok@ne\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@nf\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.49}{##1}}}
\expandafter\def\csname PYG@tok@si\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.44,0.63,0.82}{##1}}}
\expandafter\def\csname PYG@tok@s2\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@vi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@nt\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.45}{##1}}}
\expandafter\def\csname PYG@tok@nv\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@s1\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@gp\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\expandafter\def\csname PYG@tok@sh\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@ow\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@sx\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\expandafter\def\csname PYG@tok@bp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@c1\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@kc\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@c\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@mf\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@err\endcsname{\def\PYG@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PYG@tok@kd\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@ss\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.32,0.47,0.09}{##1}}}
\expandafter\def\csname PYG@tok@sr\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.14,0.33,0.53}{##1}}}
\expandafter\def\csname PYG@tok@mo\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@mi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@kn\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@o\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PYG@tok@kr\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@s\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@kp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@w\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PYG@tok@kt\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.56,0.13,0.00}{##1}}}
\expandafter\def\csname PYG@tok@sc\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@sb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@k\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@se\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@sd\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}

\def\PYGZbs{\char`\\}
\def\PYGZus{\char`\_}
\def\PYGZob{\char`\{}
\def\PYGZcb{\char`\}}
\def\PYGZca{\char`\^}
\def\PYGZam{\char`\&}
\def\PYGZlt{\char`\<}
\def\PYGZgt{\char`\>}
\def\PYGZsh{\char`\#}
\def\PYGZpc{\char`\%}
\def\PYGZdl{\char`\$}
\def\PYGZti{\char`\~}
% for compatibility with earlier versions
\def\PYGZat{@}
\def\PYGZlb{[}
\def\PYGZrb{]}
\makeatother

\begin{document}

\maketitle
\tableofcontents
\phantomsection\label{contents::doc}



\chapter{PhreeqPy - Python Tools for PHREEQC}
\label{index:full-phreecpy-documentation}\label{index:toc}\label{index::doc}\label{index:phreeqpy-python-tools-for-phreeqc}

\section{Introduction}
\label{index:introduction}
PhreeqPy is Open Source software and provides Python tools to work with
\href{http://wwwbrr.cr.usgs.gov/projects/GWC\_coupled/phreeqc/index.html}{PHREEQC}.

Currently it provides access to the new \href{ftp://brrftp.cr.usgs.gov/pub/charlton/iphreeqc/IPhreeqc.pdf}{IPhreeqc} interface without the need to
run a COM server and therefore also works on non-Windows systems.
IPhreeqc is described in more detail in this \href{http://www.sciencedirect.com/science/article/pii/S0098300411000653}{publication}.

Please let us know what you do with PhreeqPy or if things do not work
as expected. There is a
\href{https://groups.google.com/forum/\#!forum/phreeqpy-users}{mailing list for PhreeqPy}.
Just sent us you email address to subscribe with the header \emph{subscribe to phreeqpy list}.

Download latest version of this documentation as PDF

\textbf{License}: BSD


\section{Installation}
\label{index:installation}\label{index:id1}
\textbf{Pythons (tested)}: Python 2.6, 2.7, 3.3, PyPy

\textbf{Pythons (untested but should work since using ctypes)}: IronPython, Jython 2.7

\textbf{Platforms}: Unix/Posix and Windows

\textbf{PyPI package name}: \href{http://pypi.python.org/pypi/phreeqpy}{phreeqpy}

1.) Installation options:

\begin{Verbatim}[commandchars=\\\{\}]
pip install -U phreeqpy \# or
easy\_install -U phreeqpy
\end{Verbatim}

2.) Download:

\begin{Verbatim}[commandchars=\\\{\}]
wget wget http://www.phreeqpy.com/download/phreeqpy-0.2.0.tar.gz
tar -xzvf phreeqpy-0.2.0.tar.gz
cd phreeqpy-0.2.0
sudo python setup install
\end{Verbatim}

You need an IPhreeqc shared libray for your operating system. PhreeqPy comes
with shared libraries for 32-bit Windows, 32-bit Linux and 64-bit Mac OS X.
More shared libraries for differnet platforms will come with following releases.

You may download an appropriate library from here:
\href{ftp://brrftp.cr.usgs.gov/pub/charlton/iphreeqc/}{ftp://brrftp.cr.usgs.gov/pub/charlton/iphreeqc/}

For example for Linux:

\begin{Verbatim}[commandchars=\\\{\}]
wget ftp://brrftp.cr.usgs.gov/pub/charlton/iphreeqc/iphreeqc-2.18.4-6386.tar.gz
tar -xzvf iphreeqc-2.18.4-6386.tar.gz
cd iphreeqc-2.18.4-6386
./configure
make
make check
sudo make install
\end{Verbatim}

Then either use the full path to the shared libray when making an instance of
\code{phreeqc\_dll.IPhreeqc}

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{n}{phreeqc} \PYG{o}{=} \PYG{n}{phreeqpy}\PYG{o}{.}\PYG{n}{iphreeqc}\PYG{o}{.}\PYG{n}{phreeqc\PYGZus{}dll}\PYG{o}{.}\PYG{n}{IPhreeqc}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s}{/full/path/to/libiphreeqc.so}\PYG{l+s}{'}\PYG{p}{)}
\end{Verbatim}

or copy the shared object into \code{phreeqpy/iphreeqc} replacing the existing
one. For example:

\begin{Verbatim}[commandchars=\\\{\}]
sudo cp /usr/local/lib/libiphreeqc.so  /path/to/site-pacges/PhreeqPy-0.2.0-py2.7.egg/phreeqpy/iphreeqc/libiphreeqc.so.0.0.0
\end{Verbatim}


\section{Benchmark Test Comparing PhreeqPy to External Processes, COM and C++}
\label{index:benchmark-test-comparing-phreeqpy-to-external-processes-com-and-c}
This publication demonstrates how PhreeqPy can be used for reactive transport
modeling.

MÃ¼ller M., Parkhurst D.L., Charlton S.R. (2011)
Programming PHREEQC Calculations with C++ and Python - A Comparative Study ,
In: Maxwell R., Poeter E., Hill M., Zheng C. (2011) MODFLOW and More 2011 -
Integrated Hydrological Modeling, Proceedings, pp. 632 - 636.


\chapter{Class IPhreeqc}
\label{iphreeqc:class-iphreeqc}\label{iphreeqc::doc}\label{iphreeqc:sent-us-you-email-address}
This is the main class to work with the IPhreeqc interface.

You can {\hyperref[index:installation]{\emph{add your own shared library for IPhreeqc}}}.
\phantomsection\label{iphreeqc:module-phreeqpy.iphreeqc.phreeqc_dll}\index{phreeqpy.iphreeqc.phreeqc\_dll (module)}
Access PHREEQC-DLL via ctypes.

This is exchangeable with the COM interface.
\index{IPhreeqc (class in phreeqpy.iphreeqc.phreeqc\_dll)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc}\pysiglinewithargsret{\strong{class }\code{phreeqpy.iphreeqc.phreeqc\_dll.}\bfcode{IPhreeqc}}{\emph{dll\_path=None}}{}
Wrapper for the IPhreeqc DLL.

Connect to DLL and create IPhreeqc.

The optional \emph{dll\_path} takes a path to the IPhreeqc shared library.
If not provided it tries to select an appropriate library.
Make sure you have the right library for your operating system.
You may download one from here:
\href{ftp://brrftp.cr.usgs.gov/pub/charlton/iphreeqc/}{ftp://brrftp.cr.usgs.gov/pub/charlton/iphreeqc/}

See the PhreeqPy documentation for help on compiling a IPhreeqc shared
library.
\index{accumulate\_line() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.accumulate_line}\pysiglinewithargsret{\bfcode{accumulate\_line}}{\emph{line}}{}
Put line in input buffer.

\end{fulllineitems}

\index{add\_error() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.add_error}\pysiglinewithargsret{\bfcode{add\_error}}{\emph{phc\_error\_msg}}{}
Add an error message to Phreeqc.

\end{fulllineitems}

\index{add\_warning() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.add_warning}\pysiglinewithargsret{\bfcode{add\_warning}}{\emph{phc\_warn\_msg}}{}
Add an warning message to Phreeqc.

\end{fulllineitems}

\index{clear\_accumlated\_lines() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.clear_accumlated_lines}\pysiglinewithargsret{\bfcode{clear\_accumlated\_lines}}{}{}
Clear the input buffer.

\end{fulllineitems}

\index{column\_count (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc attribute)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.column_count}\pysigline{\bfcode{column\_count}}
Get number of columns in selected output.

\end{fulllineitems}

\index{component\_count (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc attribute)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.component_count}\pysigline{\bfcode{component\_count}}
Return the number of components.

\end{fulllineitems}

\index{create\_iphreeqc() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.create_iphreeqc}\pysiglinewithargsret{\bfcode{create\_iphreeqc}}{}{}
Create a IPhreeqc object.

\end{fulllineitems}

\index{destroy\_iphreeqc() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.destroy_iphreeqc}\pysiglinewithargsret{\bfcode{destroy\_iphreeqc}}{}{}
Delete the current instance of IPhreeqc.

\end{fulllineitems}

\index{get\_component() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_component}\pysiglinewithargsret{\bfcode{get\_component}}{\emph{index}}{}
Get one component.

\end{fulllineitems}

\index{get\_component\_list() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_component_list}\pysiglinewithargsret{\bfcode{get\_component\_list}}{}{}
Return all component names.

\end{fulllineitems}

\index{get\_error\_string() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_error_string}\pysiglinewithargsret{\bfcode{get\_error\_string}}{}{}
Retrieves the error messages.

\end{fulllineitems}

\index{get\_selected\_output\_array() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_selected_output_array}\pysiglinewithargsret{\bfcode{get\_selected\_output\_array}}{}{}
Get all values from selected output.

\end{fulllineitems}

\index{get\_selected\_output\_column() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_selected_output_column}\pysiglinewithargsret{\bfcode{get\_selected\_output\_column}}{\emph{col}}{}
Get all values for one column from selected output.

\end{fulllineitems}

\index{get\_selected\_output\_row() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_selected_output_row}\pysiglinewithargsret{\bfcode{get\_selected\_output\_row}}{\emph{row}}{}
Get all values for one from selected output.

\end{fulllineitems}

\index{get\_selected\_output\_value() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_selected_output_value}\pysiglinewithargsret{\bfcode{get\_selected\_output\_value}}{\emph{row}, \emph{col}}{}
Get one value from selected output at given row and column.

\end{fulllineitems}

\index{load\_database() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.load_database}\pysiglinewithargsret{\bfcode{load\_database}}{\emph{database\_name}}{}
Load a database with given file\_name.

\end{fulllineitems}

\index{load\_database\_string() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.load_database_string}\pysiglinewithargsret{\bfcode{load\_database\_string}}{\emph{input\_string}}{}
Load a datbase from a string.

\end{fulllineitems}

\index{raise\_ipq\_error() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc static method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.raise_ipq_error}\pysiglinewithargsret{\strong{static }\bfcode{raise\_ipq\_error}}{\emph{error\_code}}{}
There was an error, raise an exception.

\end{fulllineitems}

\index{raise\_string\_error() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.raise_string_error}\pysiglinewithargsret{\bfcode{raise\_string\_error}}{\emph{errors}}{}
Raise an exception with message from IPhreeqc error.

\end{fulllineitems}

\index{row\_count (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc attribute)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.row_count}\pysigline{\bfcode{row\_count}}
Get number of rows in selected output.

\end{fulllineitems}

\index{run\_string() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.run_string}\pysiglinewithargsret{\bfcode{run\_string}}{\emph{cmd\_string}}{}
Run PHREEQC input from string.

\end{fulllineitems}

\index{set\_selected\_output\_file\_off() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.set_selected_output_file_off}\pysiglinewithargsret{\bfcode{set\_selected\_output\_file\_off}}{}{}
Turn on writing to selected output file.

\end{fulllineitems}

\index{set\_selected\_output\_file\_on() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.set_selected_output_file_on}\pysiglinewithargsret{\bfcode{set\_selected\_output\_file\_on}}{}{}
Turn on writing to selected output file.

\end{fulllineitems}


\end{fulllineitems}

\index{PhreeqcException}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.PhreeqcException}\pysigline{\strong{exception }\code{phreeqpy.iphreeqc.phreeqc\_dll.}\bfcode{PhreeqcException}}
Error in Phreeqc call.

\end{fulllineitems}

\index{VAR (class in phreeqpy.iphreeqc.phreeqc\_dll)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.VAR}\pysigline{\strong{class }\code{phreeqpy.iphreeqc.phreeqc\_dll.}\bfcode{VAR}}
Struct with data type and data values.

See Var.h in PHREEQC source.

\end{fulllineitems}

\index{VARUNION (class in phreeqpy.iphreeqc.phreeqc\_dll)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.VARUNION}\pysigline{\strong{class }\code{phreeqpy.iphreeqc.phreeqc\_dll.}\bfcode{VARUNION}}
Union with types.

See Var.h in PHREEQC source.

\end{fulllineitems}

\index{bytes() (in module phreeqpy.iphreeqc.phreeqc\_dll)}

\begin{fulllineitems}
\phantomsection\label{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.bytes}\pysiglinewithargsret{\code{phreeqpy.iphreeqc.phreeqc\_dll.}\bfcode{bytes}}{\emph{str\_}, \emph{encoding}}{}
Compatibilty function for Python 3.

\end{fulllineitems}



\chapter{Examples for PhreeqPy}
\label{examples:examples-for-phreeqpy}\label{examples::doc}
This is an example for the use PhreeqPy for one-dimensional advection.
It is the example 11 from the PHREEQC users manual.

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{l+s+sd}{"""Advection with DLL or COM server.}

\PYG{l+s+sd}{Using MODFIY we update the concentration on every}
\PYG{l+s+sd}{time step. We shift by one cell per step.}
\PYG{l+s+sd}{"""}

\PYG{k+kn}{from} \PYG{n+nn}{\PYGZus{}\PYGZus{}future\PYGZus{}\PYGZus{}} \PYG{k+kn}{import} \PYG{n}{print\PYGZus{}function}

\PYG{k+kn}{import} \PYG{n+nn}{sys}

\PYG{c}{\PYGZsh{} Simple Python 3 compatiblity adjustment.}
\PYG{k}{if} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{version\PYGZus{}info}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{==} \PYG{l+m+mi}{2}\PYG{p}{:}
    \PYG{n+nb}{range} \PYG{o}{=} \PYG{n+nb}{xrange}

\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{timeit}

\PYG{n}{MODE} \PYG{o}{=} \PYG{l+s}{'}\PYG{l+s}{dll}\PYG{l+s}{'}  \PYG{c}{\PYGZsh{} 'dll' or 'com'}

\PYG{k}{if} \PYG{n}{MODE} \PYG{o}{==} \PYG{l+s}{'}\PYG{l+s}{com}\PYG{l+s}{'}\PYG{p}{:}
    \PYG{k+kn}{import} \PYG{n+nn}{phreeqpy.iphreeqc.phreeqc\PYGZus{}com} \PYG{k+kn}{as} \PYG{n+nn}{phreeqc\PYGZus{}mod}
\PYG{k}{elif} \PYG{n}{MODE} \PYG{o}{==} \PYG{l+s}{'}\PYG{l+s}{dll}\PYG{l+s}{'}\PYG{p}{:}
    \PYG{k+kn}{import} \PYG{n+nn}{phreeqpy.iphreeqc.phreeqc\PYGZus{}dll} \PYG{k+kn}{as} \PYG{n+nn}{phreeqc\PYGZus{}mod}
\PYG{k}{else}\PYG{p}{:}
    \PYG{k}{raise} \PYG{n+ne}{Exception}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s}{Mode }\PYG{l+s}{"}\PYG{l+s+si}{\PYGZpc{}s}\PYG{l+s}{"}\PYG{l+s}{ is not defined use }\PYG{l+s}{"}\PYG{l+s}{com}\PYG{l+s}{"}\PYG{l+s}{ or }\PYG{l+s}{"}\PYG{l+s}{dll}\PYG{l+s}{"}\PYG{l+s}{.}\PYG{l+s}{'} \PYG{o}{\PYGZpc{}} \PYG{n}{MODE}\PYG{p}{)}


\PYG{k}{def} \PYG{n+nf}{make\PYGZus{}initial\PYGZus{}conditions}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{"""}
\PYG{l+s+sd}{    Specify initial conditions data blocks.}

\PYG{l+s+sd}{    Uniform initial conditions are assumed.}
\PYG{l+s+sd}{    """}
    \PYG{n}{initial\PYGZus{}conditions} \PYG{o}{=} \PYG{l+s}{"""}
\PYG{l+s}{    TITLE Example 11.--Transport and ion exchange.}
\PYG{l+s}{    SOLUTION 0  CaCl2}
\PYG{l+s}{        units            mmol/kgw}
\PYG{l+s}{        temp             25.0}
\PYG{l+s}{        pH               7.0     charge}
\PYG{l+s}{        pe               12.5    O2(g)   -0.68}
\PYG{l+s}{        Ca               0.6}
\PYG{l+s}{        Cl               1.2}
\PYG{l+s}{    SOLUTION 1  Initial solution for column}
\PYG{l+s}{        units            mmol/kgw}
\PYG{l+s}{        temp             25.0}
\PYG{l+s}{        pH               7.0     charge}
\PYG{l+s}{        pe               12.5    O2(g)   -0.68}
\PYG{l+s}{        Na               1.0}
\PYG{l+s}{        K                0.2}
\PYG{l+s}{        N(5)             1.2}
\PYG{l+s}{        END}
\PYG{l+s}{    EXCHANGE 1}
\PYG{l+s}{        equilibrate 1}
\PYG{l+s}{        X                0.0011}
\PYG{l+s}{    END}
\PYG{l+s}{        }\PYG{l+s}{"""}
    \PYG{k}{return} \PYG{n}{initial\PYGZus{}conditions}


\PYG{k}{def} \PYG{n+nf}{make\PYGZus{}selected\PYGZus{}output}\PYG{p}{(}\PYG{n}{components}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{"""}
\PYG{l+s+sd}{    Build SELECTED\PYGZus{}OUTPUT data block}
\PYG{l+s+sd}{    """}
    \PYG{n}{headings} \PYG{o}{=} \PYG{l+s}{"}\PYG{l+s}{-headings    cb    H    O    }\PYG{l+s}{"}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{components}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{headings} \PYG{o}{+}\PYG{o}{=} \PYG{n}{components}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{+} \PYG{l+s}{"}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s}{"}
    \PYG{n}{selected\PYGZus{}output} \PYG{o}{=} \PYG{l+s}{"""}
\PYG{l+s}{    SELECTED\PYGZus{}OUTPUT}
\PYG{l+s}{        -reset false}
\PYG{l+s}{    USER\PYGZus{}PUNCH}
\PYG{l+s}{    }\PYG{l+s}{"""}
    \PYG{n}{selected\PYGZus{}output} \PYG{o}{+}\PYG{o}{=} \PYG{n}{headings} \PYG{o}{+} \PYG{l+s}{"}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{"}
    \PYG{c}{\PYGZsh{}}
    \PYG{c}{\PYGZsh{} charge balance, H, and O}
    \PYG{c}{\PYGZsh{}}
    \PYG{n}{code} \PYG{o}{=} \PYG{l+s}{'}\PYG{l+s}{10 w = TOT(}\PYG{l+s}{"}\PYG{l+s}{water}\PYG{l+s}{"}\PYG{l+s}{)}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{'}
    \PYG{n}{code} \PYG{o}{+}\PYG{o}{=} \PYG{l+s}{'}\PYG{l+s}{20 PUNCH CHARGE\PYGZus{}BALANCE, TOTMOLE(}\PYG{l+s}{"}\PYG{l+s}{H}\PYG{l+s}{"}\PYG{l+s}{), TOTMOLE(}\PYG{l+s}{"}\PYG{l+s}{O}\PYG{l+s}{"}\PYG{l+s}{)}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{'}
    \PYG{c}{\PYGZsh{}}
    \PYG{c}{\PYGZsh{} All other elements}
    \PYG{c}{\PYGZsh{}}
    \PYG{n}{lino} \PYG{o}{=} \PYG{l+m+mi}{30}
    \PYG{k}{for} \PYG{n}{component} \PYG{o+ow}{in} \PYG{n}{components}\PYG{p}{:}
        \PYG{n}{code} \PYG{o}{+}\PYG{o}{=} \PYG{l+s}{'}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s}{ PUNCH w*TOT(}\PYG{l+s+se}{\PYGZbs{}"}\PYG{l+s+si}{\PYGZpc{}s}\PYG{l+s+se}{\PYGZbs{}"}\PYG{l+s}{)}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{'} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{lino}\PYG{p}{,} \PYG{n}{component}\PYG{p}{)}
        \PYG{n}{lino} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{10}
    \PYG{n}{selected\PYGZus{}output} \PYG{o}{+}\PYG{o}{=} \PYG{n}{code}
    \PYG{k}{return} \PYG{n}{selected\PYGZus{}output}


\PYG{k}{def} \PYG{n+nf}{initialize}\PYG{p}{(}\PYG{n}{cells}\PYG{p}{,} \PYG{n}{first}\PYG{o}{=}\PYG{n+nb+bp}{False}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{"""}
\PYG{l+s+sd}{    Initialize IPhreeqc module}
\PYG{l+s+sd}{    """}
    \PYG{n}{phreeqc} \PYG{o}{=} \PYG{n}{phreeqc\PYGZus{}mod}\PYG{o}{.}\PYG{n}{IPhreeqc}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{load\PYGZus{}database}\PYG{p}{(}\PYG{l+s}{r"}\PYG{l+s}{phreeqc.dat}\PYG{l+s}{"}\PYG{p}{)}
    \PYG{n}{initial\PYGZus{}conditions} \PYG{o}{=} \PYG{n}{make\PYGZus{}initial\PYGZus{}conditions}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{run\PYGZus{}string}\PYG{p}{(}\PYG{n}{initial\PYGZus{}conditions}\PYG{p}{)}
    \PYG{n}{components} \PYG{o}{=} \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{get\PYGZus{}component\PYGZus{}list}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{selected\PYGZus{}output} \PYG{o}{=} \PYG{n}{make\PYGZus{}selected\PYGZus{}output}\PYG{p}{(}\PYG{n}{components}\PYG{p}{)}
    \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{run\PYGZus{}string}\PYG{p}{(}\PYG{n}{selected\PYGZus{}output}\PYG{p}{)}
    \PYG{n}{phc\PYGZus{}string} \PYG{o}{=} \PYG{l+s}{"}\PYG{l+s}{RUN\PYGZus{}CELLS; -cells 0-1}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{"}
    \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{run\PYGZus{}string}\PYG{p}{(}\PYG{n}{phc\PYGZus{}string}\PYG{p}{)}
    \PYG{n}{conc} \PYG{o}{=} \PYG{n}{get\PYGZus{}selected\PYGZus{}output}\PYG{p}{(}\PYG{n}{phreeqc}\PYG{p}{)}
    \PYG{n}{inflow} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
    \PYG{n}{initial} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
    \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{conc}\PYG{p}{:}
        \PYG{k}{if} \PYG{n}{first}\PYG{p}{:}
            \PYG{n}{inflow}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]} \PYG{o}{=} \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{inflow}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]} \PYG{o}{=} \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
        \PYG{n}{initial}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]} \PYG{o}{=} \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
    \PYG{n}{task} \PYG{o}{=} \PYG{n}{initial\PYGZus{}conditions} \PYG{o}{+} \PYG{l+s}{"}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{"}
    \PYG{n}{task} \PYG{o}{+}\PYG{o}{=} \PYG{l+s}{"}\PYG{l+s}{COPY solution 1 }\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s}{-}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{"} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{task} \PYG{o}{+}\PYG{o}{=} \PYG{l+s}{"}\PYG{l+s}{COPY exchange 1 }\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s}{-}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{"} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{task} \PYG{o}{+}\PYG{o}{=} \PYG{l+s}{"}\PYG{l+s}{END}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{"}
    \PYG{n}{task} \PYG{o}{+}\PYG{o}{=} \PYG{l+s}{"}\PYG{l+s}{RUN\PYGZus{}CELLS; -cells }\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s}{-}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{"} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{task} \PYG{o}{+}\PYG{o}{=} \PYG{n}{selected\PYGZus{}output}
    \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{run\PYGZus{}string}\PYG{p}{(}\PYG{n}{task}\PYG{p}{)}
    \PYG{n}{conc} \PYG{o}{=} \PYG{n}{get\PYGZus{}selected\PYGZus{}output}\PYG{p}{(}\PYG{n}{phreeqc}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{conc}\PYG{p}{:}
        \PYG{n}{value} \PYG{o}{=} \PYG{p}{[}\PYG{n}{initial}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{]} \PYG{o}{*} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]} \PYG{o}{=} \PYG{n}{value}
    \PYG{k}{return} \PYG{n}{phreeqc}\PYG{p}{,} \PYG{n}{inflow}\PYG{p}{,} \PYG{n}{conc}


\PYG{k}{def} \PYG{n+nf}{advect\PYGZus{}step}\PYG{p}{(}\PYG{n}{phreeqc}\PYG{p}{,} \PYG{n}{inflow}\PYG{p}{,} \PYG{n}{conc}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{"""Advect by shifting concentrations from previous time step.}
\PYG{l+s+sd}{    """}
    \PYG{n}{all\PYGZus{}names} \PYG{o}{=} \PYG{n}{conc}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{names} \PYG{o}{=} \PYG{p}{[}\PYG{n}{name} \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{all\PYGZus{}names} \PYG{k}{if} \PYG{n}{name} \PYG{o+ow}{not} \PYG{o+ow}{in} \PYG{p}{(}\PYG{l+s}{'}\PYG{l+s}{cb}\PYG{l+s}{'}\PYG{p}{,} \PYG{l+s}{'}\PYG{l+s}{H}\PYG{l+s}{'}\PYG{p}{,} \PYG{l+s}{'}\PYG{l+s}{O}\PYG{l+s}{'}\PYG{p}{)}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{conc}\PYG{p}{:}
        \PYG{c}{\PYGZsh{} shift one cell}
        \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{o}{-}\PYG{l+m+mi}{1}\PYG{p}{]}
        \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{inflow}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}
    \PYG{n}{modify} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{index}\PYG{p}{,} \PYG{n}{cell} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s}{"}\PYG{l+s}{SOLUTION\PYGZus{}MODIFY }\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s}{"} \PYG{o}{\PYGZpc{}} \PYG{n}{cell}\PYG{p}{)}
        \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s}{"}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s}{-cb      }\PYG{l+s+si}{\PYGZpc{}e}\PYG{l+s}{"} \PYG{o}{\PYGZpc{}} \PYG{n}{conc}\PYG{p}{[}\PYG{l+s}{'}\PYG{l+s}{cb}\PYG{l+s}{'}\PYG{p}{]}\PYG{p}{[}\PYG{n}{index}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s}{"}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s}{-total\PYGZus{}h }\PYG{l+s+si}{\PYGZpc{}f}\PYG{l+s}{"} \PYG{o}{\PYGZpc{}} \PYG{n}{conc}\PYG{p}{[}\PYG{l+s}{'}\PYG{l+s}{H}\PYG{l+s}{'}\PYG{p}{]}\PYG{p}{[}\PYG{n}{index}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s}{"}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s}{-total\PYGZus{}o }\PYG{l+s+si}{\PYGZpc{}f}\PYG{l+s}{"} \PYG{o}{\PYGZpc{}} \PYG{n}{conc}\PYG{p}{[}\PYG{l+s}{'}\PYG{l+s}{O}\PYG{l+s}{'}\PYG{p}{]}\PYG{p}{[}\PYG{n}{index}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s}{"}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s}{-totals}\PYG{l+s}{"}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{names}\PYG{p}{:}
            \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s}{"}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+si}{\PYGZpc{}s}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+si}{\PYGZpc{}f}\PYG{l+s}{"} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{name}\PYG{p}{,} \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{n}{index}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s}{"}\PYG{l+s}{RUN\PYGZus{}CELLS; -cells }\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s}{-}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{"} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{cmd} \PYG{o}{=} \PYG{l+s}{'}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{'}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{modify}\PYG{p}{)}
    \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{run\PYGZus{}string}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{)}
    \PYG{n}{conc} \PYG{o}{=} \PYG{n}{get\PYGZus{}selected\PYGZus{}output}\PYG{p}{(}\PYG{n}{phreeqc}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{conc}


\PYG{k}{def} \PYG{n+nf}{get\PYGZus{}selected\PYGZus{}output}\PYG{p}{(}\PYG{n}{phreeqc}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{"""Return calculation result as dict.}

\PYG{l+s+sd}{    Header entries are the keys and the columns}
\PYG{l+s+sd}{    are the values as lists of numbers.}
\PYG{l+s+sd}{    """}
    \PYG{n}{output} \PYG{o}{=} \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{get\PYGZus{}selected\PYGZus{}output\PYGZus{}array}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{header} \PYG{o}{=} \PYG{n}{output}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{conc} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
    \PYG{k}{for} \PYG{n}{head} \PYG{o+ow}{in} \PYG{n}{header}\PYG{p}{:}
        \PYG{n}{conc}\PYG{p}{[}\PYG{n}{head}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{row} \PYG{o+ow}{in} \PYG{n}{output}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{p}{]}\PYG{p}{:}
        \PYG{k}{for} \PYG{n}{col}\PYG{p}{,} \PYG{n}{head} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{header}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{conc}\PYG{p}{[}\PYG{n}{head}\PYG{p}{]}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{row}\PYG{p}{[}\PYG{n}{col}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{conc}


\PYG{k}{def} \PYG{n+nf}{run}\PYG{p}{(}\PYG{n}{ncells}\PYG{p}{,} \PYG{n}{shifts}\PYG{p}{,} \PYG{n}{specie\PYGZus{}names}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{"""Do one run in one process.}
\PYG{l+s+sd}{    """}
    \PYG{n}{cells} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{ncells}\PYG{p}{)}
    \PYG{n}{phreeqc}\PYG{p}{,} \PYG{n}{inflow}\PYG{p}{,} \PYG{n}{conc} \PYG{o}{=} \PYG{n}{initialize}\PYG{p}{(}\PYG{n}{cells}\PYG{p}{,} \PYG{n}{first}\PYG{o}{=}\PYG{n+nb+bp}{True}\PYG{p}{)}
    \PYG{n}{outflow} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
    \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{specie\PYGZus{}names}\PYG{p}{:}
        \PYG{n}{outflow}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{\PYGZus{}counter} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{shifts}\PYG{p}{)}\PYG{p}{:}
        \PYG{c}{\PYGZsh{} advect}
        \PYG{n}{conc} \PYG{o}{=} \PYG{n}{advect\PYGZus{}step}\PYG{p}{(}\PYG{n}{phreeqc}\PYG{p}{,} \PYG{n}{inflow}\PYG{p}{,} \PYG{n}{conc}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{specie\PYGZus{}names}\PYG{p}{:}
            \PYG{n}{outflow}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{o}{-}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{outflow}


\PYG{k}{def} \PYG{n+nf}{write\PYGZus{}outflow}\PYG{p}{(}\PYG{n}{file\PYGZus{}name}\PYG{p}{,} \PYG{n}{outflow}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{"""Write the outflow values to a file.}
\PYG{l+s+sd}{    """}
    \PYG{n}{fobj} \PYG{o}{=} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{file\PYGZus{}name}\PYG{p}{,} \PYG{l+s}{'}\PYG{l+s}{w}\PYG{l+s}{'}\PYG{p}{)}
    \PYG{n}{header} \PYG{o}{=} \PYG{n}{outflow}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{head} \PYG{o+ow}{in} \PYG{n}{header}\PYG{p}{:}
        \PYG{n}{fobj}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s+si}{\PYGZpc{}20s}\PYG{l+s}{'} \PYG{o}{\PYGZpc{}} \PYG{n}{head}\PYG{p}{)}
    \PYG{n}{fobj}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{'}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{lineno} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{outflow}\PYG{p}{[}\PYG{n}{head}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{for} \PYG{n}{head} \PYG{o+ow}{in} \PYG{n}{header}\PYG{p}{:}
            \PYG{n}{fobj}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s+si}{\PYGZpc{}20.17f}\PYG{l+s}{'} \PYG{o}{\PYGZpc{}} \PYG{n}{outflow}\PYG{p}{[}\PYG{n}{head}\PYG{p}{]}\PYG{p}{[}\PYG{n}{lineno}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{fobj}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{'}\PYG{p}{)}


\PYG{k}{def} \PYG{n+nf}{main}\PYG{p}{(}\PYG{n}{ncells}\PYG{p}{,} \PYG{n}{shifts}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{"""Run different versions with and without multiprocessing}
\PYG{l+s+sd}{    """}

    \PYG{k}{def} \PYG{n+nf}{measure\PYGZus{}time}\PYG{p}{(}\PYG{n}{func}\PYG{p}{,} \PYG{o}{*}\PYG{n}{args}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}\PYG{p}{:}
        \PYG{l+s+sd}{"""Convinience function to measure run times.}
\PYG{l+s+sd}{        """}
        \PYG{n}{start} \PYG{o}{=} \PYG{n}{timeit}\PYG{o}{.}\PYG{n}{default\PYGZus{}timer}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{result} \PYG{o}{=} \PYG{n}{func}\PYG{p}{(}\PYG{o}{*}\PYG{n}{args}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{result}\PYG{p}{,} \PYG{n}{timeit}\PYG{o}{.}\PYG{n}{default\PYGZus{}timer}\PYG{p}{(}\PYG{p}{)} \PYG{o}{-} \PYG{n}{start}

    \PYG{k}{print}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s}{Dimensions}\PYG{l+s}{'}\PYG{p}{)}
    \PYG{k}{print}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s}{==========}\PYG{l+s}{'}\PYG{p}{)}
    \PYG{k}{print}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s}{number of cells:   }\PYG{l+s}{'}\PYG{p}{,} \PYG{n}{ncells}\PYG{p}{)}
    \PYG{k}{print}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s}{number of shifts   }\PYG{l+s}{'}\PYG{p}{,} \PYG{n}{shifts}\PYG{p}{)}
    \PYG{n}{specie\PYGZus{}names} \PYG{o}{=} \PYG{p}{(}\PYG{l+s}{'}\PYG{l+s}{Ca}\PYG{l+s}{'}\PYG{p}{,} \PYG{l+s}{'}\PYG{l+s}{Cl}\PYG{l+s}{'}\PYG{p}{,} \PYG{l+s}{'}\PYG{l+s}{K}\PYG{l+s}{'}\PYG{p}{,} \PYG{l+s}{'}\PYG{l+s}{N}\PYG{l+s}{'}\PYG{p}{,} \PYG{l+s}{'}\PYG{l+s}{Na}\PYG{l+s}{'}\PYG{p}{)}
    \PYG{n}{outflow}\PYG{p}{,} \PYG{n}{run\PYGZus{}time} \PYG{o}{=} \PYG{n}{measure\PYGZus{}time}\PYG{p}{(}\PYG{n}{run}\PYG{p}{,} \PYG{n}{ncells}\PYG{p}{,} \PYG{n}{shifts}\PYG{p}{,} \PYG{n}{specie\PYGZus{}names}\PYG{p}{)}
    \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{exists}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s}{data}\PYG{l+s}{'}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{os}\PYG{o}{.}\PYG{n}{mkdir}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s}{data}\PYG{l+s}{'}\PYG{p}{)}
    \PYG{n}{write\PYGZus{}outflow}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s}{data/out.txt}\PYG{l+s}{'}\PYG{p}{,} \PYG{n}{outflow}\PYG{p}{)}
    \PYG{k}{print}\PYG{p}{(}\PYG{l+s}{'}\PYG{l+s}{run time:}\PYG{l+s}{'}\PYG{p}{,} \PYG{n}{run\PYGZus{}time}\PYG{p}{)}
    \PYG{k}{print}\PYG{p}{(}\PYG{l+s}{"}\PYG{l+s}{Finished simulation}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{"}\PYG{p}{)}

\PYG{k}{if} \PYG{n}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s}{'}\PYG{l+s}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s}{'}\PYG{p}{:}
    \PYG{n}{main}\PYG{p}{(}\PYG{n}{ncells}\PYG{o}{=}\PYG{l+m+mi}{40}\PYG{p}{,} \PYG{n}{shifts}\PYG{o}{=}\PYG{l+m+mi}{120}\PYG{p}{)}
\end{Verbatim}


\chapter{Changelog history}
\label{changelog:changelog-history}\label{changelog::doc}\label{changelog:changelog}

\section{Changes between versions 0.1 and 0.2}
\label{changelog:changes-between-versions-0-1-and-0-2}\begin{itemize}
\item {} 
Added more IPhreeqc functions.

\item {} 
Added support for Mac OS X.

\item {} 
Added error handling turning IPhreeqc errors into Python exceptions.

\item {} 
Added Python 3 compatibility. Tested with Python 3.3.

\item {} 
Added documentation in addition to example on website.

\end{itemize}


\chapter{Contact}
\label{contact:contact}\label{contact::doc}
\begin{DUlineblock}{0em}
\item[] hydrocomputing GmbH \& Co. KG
\item[] Zur Schule 20
\item[] 04158 Leipzig
\item[] Germany
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Tel: +49 341 525 599 54
\item[] Fax: +49 341 520 4495
\item[] mail: info {[}at{]} hydrocomputing {[}dot{]} com
\item[] www: \href{http://www.hydrocomputing.com}{http://www.hydrocomputing.com}
\end{DUlineblock}


\chapter{Indices and tables}
\label{contents:indices-and-tables}\begin{itemize}
\item {} 
\emph{genindex}

\item {} 
\emph{modindex}

\item {} 
\emph{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{theindex}
\def\bigletter#1{{\Large\sffamily#1}\nopagebreak\vspace{1mm}}
\bigletter{p}
\item {\texttt{phreeqpy.iphreeqc.phreeqc\_dll}}, \pageref{iphreeqc:module-phreeqpy.iphreeqc.phreeqc_dll}
\end{theindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}
